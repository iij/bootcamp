<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>IIJ Bootcamp</title>
    <meta name="description" content="Railsによるサーバーアプリ実装の基礎についてハンズオンしてみましょう">
    
    
    <link rel="preload" href="/bootcamp/assets/css/0.styles.2b6a07f9.css" as="style"><link rel="preload" href="/bootcamp/assets/js/app.84399adc.js" as="script"><link rel="preload" href="/bootcamp/assets/js/2.acfdd0a4.js" as="script"><link rel="preload" href="/bootcamp/assets/js/26.f2075ce3.js" as="script"><link rel="preload" href="/bootcamp/assets/js/5.d20398c4.js" as="script"><link rel="preload" href="/bootcamp/assets/js/4.a9d4f0c2.js" as="script"><link rel="prefetch" href="/bootcamp/assets/js/10.d3d47ecb.js"><link rel="prefetch" href="/bootcamp/assets/js/11.e511d435.js"><link rel="prefetch" href="/bootcamp/assets/js/12.235145e7.js"><link rel="prefetch" href="/bootcamp/assets/js/13.2f030501.js"><link rel="prefetch" href="/bootcamp/assets/js/14.42aafd44.js"><link rel="prefetch" href="/bootcamp/assets/js/15.69d56ee8.js"><link rel="prefetch" href="/bootcamp/assets/js/16.f87c5fd4.js"><link rel="prefetch" href="/bootcamp/assets/js/17.3f35d88c.js"><link rel="prefetch" href="/bootcamp/assets/js/18.3c897ca0.js"><link rel="prefetch" href="/bootcamp/assets/js/19.97637d7d.js"><link rel="prefetch" href="/bootcamp/assets/js/20.8abaa144.js"><link rel="prefetch" href="/bootcamp/assets/js/21.687acb52.js"><link rel="prefetch" href="/bootcamp/assets/js/22.14bb7511.js"><link rel="prefetch" href="/bootcamp/assets/js/23.7a641002.js"><link rel="prefetch" href="/bootcamp/assets/js/24.81644ee3.js"><link rel="prefetch" href="/bootcamp/assets/js/25.af6760c5.js"><link rel="prefetch" href="/bootcamp/assets/js/27.ff4aa35d.js"><link rel="prefetch" href="/bootcamp/assets/js/28.556448c0.js"><link rel="prefetch" href="/bootcamp/assets/js/29.1cf4c6d9.js"><link rel="prefetch" href="/bootcamp/assets/js/3.ed6eaec0.js"><link rel="prefetch" href="/bootcamp/assets/js/30.43568e40.js"><link rel="prefetch" href="/bootcamp/assets/js/6.03563dad.js"><link rel="prefetch" href="/bootcamp/assets/js/7.936be0e4.js"><link rel="prefetch" href="/bootcamp/assets/js/8.632a3463.js"><link rel="prefetch" href="/bootcamp/assets/js/9.76124e4d.js">
    <link rel="stylesheet" href="/bootcamp/assets/css/0.styles.2b6a07f9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bootcamp/" class="home-link router-link-active"><!----> <span class="site-name">IIJ Bootcamp</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/iij/bootcamp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/iij/bootcamp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bootcamp/server-app/rails/#ruby-on-railsとは" class="sidebar-link">Ruby on Railsとは</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/server-app/rails/#railsの強み-弱み" class="sidebar-link">Railsの強み/弱み</a></li></ul></li><li><a href="/bootcamp/server-app/rails/#railsのインストール" class="sidebar-link">Railsのインストール</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bootcamp/server-app/rails/#事前準備" class="sidebar-link">事前準備</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bootcamp/server-app/rails/#rbenvのインストール" class="sidebar-link">rbenvのインストール</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/server-app/rails/#rubyのインストール" class="sidebar-link">Rubyのインストール</a></li><li class="sidebar-sub-header"><a href="/bootcamp/server-app/rails/#rails環境の準備" class="sidebar-link">Rails環境の準備</a></li><li class="sidebar-sub-header"><a href="/bootcamp/server-app/rails/#railsプロジェクトの作成" class="sidebar-link">Railsプロジェクトの作成</a></li></ul></li><li><a href="/bootcamp/server-app/rails/#まずはhello" class="sidebar-link">まずはHello</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bootcamp/server-app/rails/#scaffold" class="sidebar-link">Scaffold</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bootcamp/server-app/rails/#最後に" class="sidebar-link">最後に</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><table><tr><td>このハンズオンでやること</td><td>Railsによるサーバーアプリ実装の基礎についてハンズオンしてみましょう</td></tr> <tr><td>想定時間</td><td>1h</td></tr> <tr><td>前提知識・用語</td><td>特になし</td></tr></table> <h1 id="ruby-on-railsでwebアプリを作る"><a href="#ruby-on-railsでwebアプリを作る" class="header-anchor">#</a> Ruby on RailsでWebアプリを作る</h1> <h2 id="ruby-on-railsとは"><a href="#ruby-on-railsとは" class="header-anchor">#</a> Ruby on Railsとは</h2> <ol><li>略称はRoR、または単にRails</li> <li>Rubyで書かれたフルスタックWebアプリケーションフレームワーク</li></ol> <ul><li>哲学
<ul><li>DRY (Don't Repeat Yoursef. 同じコードは二度書かない)</li> <li>設定よりも規約 (規約にしたがって開発するかぎり、設定ファイル不
要...Rails以前に有力だったStrutsは、きまりきったことを設定ファイ
ルに書く必要があった)</li></ul></li> <li>フルスタック(必要な機能はほとんどなんでもRailsが提供)</li> <li>プロジェクト管理(プロトジェクトの立ち上げ、ライブラリのインストー
ル、データベース上のテーブルの定義/マイグレーション、テスト、リリー
ス等をコマンドで実行できるようにしている)</li> <li>Scaffold (プログラム開発の足場) の提供 (数分でWebアプリケーション
が立ち上がる! 的なデモで一世を風靡した)</li> <li>MVCアーキテクチャ (ここは、何の変哲もない感じです)</li> <li>ActiveRecord (ほとんどコードを書かずにデータベースを操作できる)</li></ul> <ol start="3"><li>爆発的に成功し、Rubyのキラーアプリケーションとなった。</li></ol> <ul><li>Railsを使いたくてRubyを学習する、という人が大量に出現した。</li></ul> <h3 id="railsの強み-弱み"><a href="#railsの強み-弱み" class="header-anchor">#</a> Railsの強み/弱み</h3> <ol><li>強み</li> <li>少ないコード量で多くの仕事</li> <li>作法が決まっているので、共同作業しやすい</li> <li>豊富なリソース (教材、サンプル、コミュニティ)</li> <li>弱み</li> <li>学習コストが高い</li> <li>約束事が多い</li> <li>性能面の問題を抱えやすい</li></ol> <p>これらの特性から、スタートアップが少数精鋭チームで初期バージョンを開発
し、成功した後で他の言語/フレームワークで書き直す、というスタイルでよ
く利用されています。</p> <h2 id="railsのインストール"><a href="#railsのインストール" class="header-anchor">#</a> Railsのインストール</h2> <ol><li>事前準備</li> <li>rbenvのインストール</li> <li>Rubyのインストール</li> <li>Rails環境の準備</li> <li>Railsプロジェクトの作成</li></ol> <h2 id="事前準備"><a href="#事前準備" class="header-anchor">#</a> 事前準備</h2> <div class="language- extra-class"><pre class="language-text"><code>$ sudo yum update
$ sudo yum install -y git
$ sudo yum install -y bzip2 gcc openssl-devel readline-devel zlib-devel sqlite-devel
</code></pre></div><h2 id="rbenvのインストール"><a href="#rbenvのインストール" class="header-anchor">#</a> rbenvのインストール</h2> <p>Railsで開発を行なうと、プロジェクト毎に異なるバージョンのRubyを使うこ
とがよくあります。そのため、yumでOSにインストールしたRubyを使うのでは
なく、プロジェクト毎に特定のバージョンのRubyを使えるように、rbenvとい
うツールを使うことが一般的です。</p> <div class="language- extra-class"><pre class="language-text"><code>$ git clone https://github.com/rbenv/rbenv.git ~/.rbenv
$ git clone git://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
</code></pre></div><p>~/.bash_profileに以下を追記</p> <div class="language- extra-class"><pre class="language-text"><code># rbenv
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;

</code></pre></div><p>反映と確認</p> <div class="language- extra-class"><pre class="language-text"><code>$ source ~/.bash_profile
$ rbenv -v # バージョンが表示される。
</code></pre></div><h3 id="rubyのインストール"><a href="#rubyのインストール" class="header-anchor">#</a> Rubyのインストール</h3> <p>Rubyのインストール可能なバージョンを確認</p> <div class="language- extra-class"><pre class="language-text"><code>$ rbenv install --list
</code></pre></div><p>任意のバージョンのRubyをインストール。(今回は2.6.3を指定）</p> <div class="language- extra-class"><pre class="language-text"><code>$ rbenv install 2.6.3 # 少しかかります(数分程度)
</code></pre></div><p>インストールしたバージョンのRubyをrbenvに設定し、確認します。</p> <div class="language- extra-class"><pre class="language-text"><code>$ rbenv global 2.6.3
$ ruby -v # Rubyが実行できることを確認
</code></pre></div><p>ちなみに...</p> <div class="language- extra-class"><pre class="language-text"><code>$ ruby -v
(rbenv管理のRubyのバージョン)
$ which ruby
(rbenv管理のRubyの場所)
$ /usr/bin/ruby -v
(OS管理のRubyのバージョン)
</code></pre></div><h3 id="rails環境の準備"><a href="#rails環境の準備" class="header-anchor">#</a> Rails環境の準備</h3> <p>bundlerをインストール</p> <div class="language- extra-class"><pre class="language-text"><code>$ gem install bundler
</code></pre></div><p>bundlerというのは、プロジェクト毎にgemを管理するためのツールです。</p> <p>gemというのは、Rubyのライブラリを管理するためのツールです。</p> <p>rbenvでプロジェクト毎に異なるバージョンのRubyを使えるようにするように、
bundlerでプロジェクト毎に異なるバージョンのライブラリを使えるようにす
るのです。</p> <p>Railsの利用可能なバージョンを確認します。</p> <div class="language- extra-class"><pre class="language-text"><code>$ gem query -ra -n  &quot;^rails$&quot;
</code></pre></div><p>Railsの任意のバージョンの環境をディレクトリにまとめます。
(今回は5.2.1を指定しました）</p> <div class="language- extra-class"><pre class="language-text"><code>$ mkdir rails_v5.2.1 # お好きな名前を
$ cd rails_v5.2.1
$ bundle init # カレントディレクトリにGemfileを作成
$ echo 'gem &quot;rails&quot;, &quot;5.2.1&quot;' &gt;&gt; Gemfile # ※ 任意のバージョンを指定
$ bundle install --path vendor/bundle # ./vendor/bundleにRails関連のGemが入る
</code></pre></div><p>以下の表示が出ることがあります。</p> <div class="language- extra-class"><pre class="language-text"><code>HEADS UP! i18n 1.1 changed fallbacks to exclude default locale.
But that may break your application.

Please check your Rails app for 'config.i18n.fallbacks = true'.
If you're using I18n (&gt;= 1.1.0) and Rails (&lt; 5.2.2), this should be
'config.i18n.fallbacks = [I18n.default_locale]'.
If not, fallbacks will be broken in your app by I18n 1.1.x.

For more info see:
https://github.com/svenfuchs/i18n/releases/tag/v1.1.0
</code></pre></div><p>これについては、さしあたり無視しておきます。(i18nを使うときまで。)</p> <h3 id="railsプロジェクトの作成"><a href="#railsプロジェクトの作成" class="header-anchor">#</a> Railsプロジェクトの作成</h3> <p>Railsのプロジェクトを、上記で作成したRailsディレクトリの中に作成します。</p> <div class="language- extra-class"><pre class="language-text"><code>$ cd ~/rails_v5.2.1 # 上記で作成したRailsディレクトリに移動
$ bundle exec rails new bootcamp --skip-bundle # プロジェクトの作成
</code></pre></div><p>bundle execはbundlerが~/rails_v5.2.1にインストールしたrailsコマンドを
実行することを指示しています。</p> <p>bootcampはプロジェクト名です。好きなように決めることができます。</p> <p>--skip-bundleはbundle installを自動で実行しないようにしています。こう
することで、このプロジェクトに必要なgemを、プロジェクト内の
vendor/bundle以下にインストールするようにしています。</p> <p>ここでbootcampディレクトリが作られるのですが、その中にあるGemfileの末
尾の方にある以下の部分を修正してください。</p> <div class="language- extra-class"><pre class="language-text"><code>group :test do
  # Adds support for Capybara system testing and selenium driver
  gem 'capybara', '&gt;= 2.15'
  gem 'selenium-webdriver'
  # Easy installation and use of chromedriver to run system tests with Chrome
  #gem 'chromedriver-helper' ここをコメントアウトして
  gem 'webdrivers' # この行を追加します。
end
</code></pre></div><p>この修正は何かというと、chromedriver-helperがEnd supportになったことへ
の対処です。</p> <div class="language- extra-class"><pre class="language-text"><code>$ cd bootcamp
$ bundle install --path vendor/bundle # ./vendor/bundleにGemをインストール
$ echo '/vendor/bundle' &gt;&gt; .gitignore # Gitの管理対象から外す
</code></pre></div><p>ここまで実行すると、すでにRailsの開発サーバを起動可能です。</p> <div class="language- extra-class"><pre class="language-text"><code>$ bundle exec rails server
</code></pre></div><p>ブラウザを起動して <a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">http://localhost:3000<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> にアクセスしてみましょう。</p> <p>Yay! You’re on Rails! と表示されていれば、インストールは完了です。</p> <h2 id="まずはhello"><a href="#まずはhello" class="header-anchor">#</a> まずはHello</h2> <p>新しいプログラミング言語を覚えるときは、最初にHelloするものです。</p> <p>（先程のサーバを起動しているターミナルはそのままにしておいて）もうひとつターミナルを開いて、以下を実行します。</p> <div class="language- extra-class"><pre class="language-text"><code>$ bundle exec rails generate controller Welcome index
</code></pre></div><p>こんな感じにコントローラ、テンプレート等が生成されます。</p> <div class="language- extra-class"><pre class="language-text"><code>      create  app/controllers/welcome_controller.rb
       route  get 'welcome/index'
      invoke  erb
      create    app/views/welcome
      create    app/views/welcome/index.html.erb
      invoke  test_unit
      create    test/controllers/welcome_controller_test.rb
      invoke  helper
      create    app/helpers/welcome_helper.rb
      invoke    test_unit
      invoke  assets
      invoke    coffee
      create      app/assets/javascripts/welcome.coffee
      invoke    scss
      create      app/assets/stylesheets/welcome.scss
</code></pre></div><p>app/controllers/welcome_controller.rbには、WelcomeControllerクラスが定
義されています。</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">WelcomeController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">index</span></span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre></div><p>ほとんど空っぽです。indexメソッドはindexアクションのためのメソッドです。</p> <p>welcomeコントローラのindexアクションに対応するテンプレートは、
app/views/welcome/index.html.erbにあります。</p> <div class="language-erb extra-class"><pre class="language-erb"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Welcome#index<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Find me in app/views/welcome/index.html.erb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>このファイルを以下のように修正しましょう。</p> <div class="language-erb extra-class"><pre class="language-erb"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello, Rails!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ブラウザで <a href="http://localhost:3000/welcome/index" target="_blank" rel="noopener noreferrer">http://localhost:3000/welcome/index<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> にアクセスしてみましょ
う。どうなりましたか。</p> <p>（開発サーバの再起動が不要だったことに注目しましょう!）</p> <h2 id="scaffold"><a href="#scaffold" class="header-anchor">#</a> Scaffold</h2> <p>最後にScaffoldを試してみましょう。</p> <p>Scaffoldは、データベースを使った、list(一覧表示)、add(追加)、remove(削
除)、edit(編集)、view(表示)の足場を提供してくれるものです。</p> <p>以下を実行しましょう。</p> <div class="language- extra-class"><pre class="language-text"><code>bundle exec rails generate scaffold idea name:string description:text
bundle exec rails db:migrate
</code></pre></div><p>1行目で、ideaという名前のscaffoldを作ります。name:stringと
description:textはデータベースに作成するideasテーブルに定義するカラムで
す。</p> <p>（Railsの「規約」では、テーブル名は複数形になります。）</p> <p>2行目で、データベース定義を実際にデータベースに反映させます。
（現在の設定では、sqlite3を使っています。）</p> <p>ブラウザで <a href="http://localhost:3000/ideas" target="_blank" rel="noopener noreferrer">http://localhost:3000/ideas<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> にアクセスしてみましょう。</p> <p>まだテーブルにデータが入っていので空の状態です。</p> <p>New Ideaリンクをクリックして、新しいデータを追加してみましょう。</p> <p>すでにデータの一覧表示、追加、編集、削除、表示ができるようになっている
のがわかると思います。</p> <p>おめでとうございます! これで、あなたはWebアプリケーションを作ることに
成功しました。</p> <p>実際のコードも読んでみましょうか。</p> <p>まずはIdeasコントローラを見てみましょう。</p> <p>app/controller/ideas_controller.rbです。</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code><span class="token keyword">class</span> <span class="token class-name">IdeasController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
  before_action <span class="token symbol">:set_idea</span><span class="token punctuation">,</span> only<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token symbol">:show</span><span class="token punctuation">,</span> <span class="token symbol">:edit</span><span class="token punctuation">,</span> <span class="token symbol">:update</span><span class="token punctuation">,</span> <span class="token symbol">:destroy</span><span class="token punctuation">]</span>

  <span class="token comment"># GET /ideas</span>
  <span class="token comment"># GET /ideas.json</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">index</span></span>
    <span class="token variable">@ideas</span> <span class="token operator">=</span> <span class="token constant">Idea</span><span class="token punctuation">.</span>all
  <span class="token keyword">end</span>

  <span class="token comment"># GET /ideas/1</span>
  <span class="token comment"># GET /ideas/1.json</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">show</span></span>
  <span class="token keyword">end</span>

  <span class="token comment"># GET /ideas/new</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">new</span></span>
    <span class="token variable">@idea</span> <span class="token operator">=</span> <span class="token constant">Idea</span><span class="token punctuation">.</span><span class="token keyword">new</span>
  <span class="token class-name">end</span>

  <span class="token comment"># GET /ideas/1/edit</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">edit</span></span>
  <span class="token keyword">end</span>

  <span class="token comment"># POST /ideas</span>
  <span class="token comment"># POST /ideas.json</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">create</span></span>
    <span class="token variable">@idea</span> <span class="token operator">=</span> <span class="token constant">Idea</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>idea_params<span class="token punctuation">)</span>

    respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
      <span class="token keyword">if</span> <span class="token variable">@idea</span><span class="token punctuation">.</span>save
        format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> redirect_to <span class="token variable">@idea</span><span class="token punctuation">,</span> notice<span class="token punctuation">:</span> <span class="token string">'Idea was successfully created.'</span> <span class="token punctuation">}</span>
        format<span class="token punctuation">.</span>json <span class="token punctuation">{</span> render <span class="token symbol">:show</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token symbol">:created</span><span class="token punctuation">,</span> location<span class="token punctuation">:</span> <span class="token variable">@idea</span> <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
        format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> render <span class="token symbol">:new</span> <span class="token punctuation">}</span>
        format<span class="token punctuation">.</span>json <span class="token punctuation">{</span> render json<span class="token punctuation">:</span> <span class="token variable">@idea</span><span class="token punctuation">.</span>errors<span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token symbol">:unprocessable_entity</span> <span class="token punctuation">}</span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token comment"># PATCH/PUT /ideas/1</span>
  <span class="token comment"># PATCH/PUT /ideas/1.json</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">update</span></span>
    respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
      <span class="token keyword">if</span> <span class="token variable">@idea</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span>idea_params<span class="token punctuation">)</span>
        format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> redirect_to <span class="token variable">@idea</span><span class="token punctuation">,</span> notice<span class="token punctuation">:</span> <span class="token string">'Idea was successfully updated.'</span> <span class="token punctuation">}</span>
        format<span class="token punctuation">.</span>json <span class="token punctuation">{</span> render <span class="token symbol">:show</span><span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token symbol">:ok</span><span class="token punctuation">,</span> location<span class="token punctuation">:</span> <span class="token variable">@idea</span> <span class="token punctuation">}</span>
      <span class="token keyword">else</span>
        format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> render <span class="token symbol">:edit</span> <span class="token punctuation">}</span>
        format<span class="token punctuation">.</span>json <span class="token punctuation">{</span> render json<span class="token punctuation">:</span> <span class="token variable">@idea</span><span class="token punctuation">.</span>errors<span class="token punctuation">,</span> status<span class="token punctuation">:</span> <span class="token symbol">:unprocessable_entity</span> <span class="token punctuation">}</span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token comment"># DELETE /ideas/1</span>
  <span class="token comment"># DELETE /ideas/1.json</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">destroy</span></span>
    <span class="token variable">@idea</span><span class="token punctuation">.</span>destroy
    respond_to <span class="token keyword">do</span> <span class="token operator">|</span>format<span class="token operator">|</span>
      format<span class="token punctuation">.</span>html <span class="token punctuation">{</span> redirect_to ideas_url<span class="token punctuation">,</span> notice<span class="token punctuation">:</span> <span class="token string">'Idea was successfully destroyed.'</span> <span class="token punctuation">}</span>
      format<span class="token punctuation">.</span>json <span class="token punctuation">{</span> head <span class="token symbol">:no_content</span> <span class="token punctuation">}</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token keyword">private</span>
    <span class="token comment"># Use callbacks to share common setup or constraints between actions.</span>
    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">set_idea</span></span>
      <span class="token variable">@idea</span> <span class="token operator">=</span> <span class="token constant">Idea</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>

    <span class="token comment"># Never trust parameters from the scary internet, only allow the white list through.</span>
    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">idea_params</span></span>
      params<span class="token punctuation">.</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token symbol">:idea</span><span class="token punctuation">)</span><span class="token punctuation">.</span>permit<span class="token punctuation">(</span><span class="token symbol">:name</span><span class="token punctuation">,</span> <span class="token symbol">:description</span><span class="token punctuation">,</span> <span class="token symbol">:picture</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre></div><p>驚くほど簡潔です。</p> <p>たとえば <code>index</code> メソッドは、インスタンス変数 <code>@ideas</code>に<code>Idea.all</code>の戻値を
代入しているだけです。</p> <p><code>Idea.all</code>は、何をしているかというと、データベースに定義したideasテー
ブルから全部の行を取得してその内容を返すというものです。</p> <p><code>show</code> メソッドに至っては中身が空ですが、こちらは冒頭に宣言されている
<code>before_action</code> によって、 <code>showメソッド</code> を実行する前に <code>set_idea</code> メ
ソッドが実行されます。その <code>set_idea</code> メソッドはというと...</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">set_idea</span></span>
      <span class="token variable">@idea</span> <span class="token operator">=</span> <span class="token constant">Idea</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span>
</code></pre></div><p>これまたたった一行です。これはリクエストパラメータ <code>id</code> で <code>ideas</code>テー
ブルの主キーを検索し、SELECTできた行をインスタンス変数 <code>@idea</code> に格納
しているだけです。</p> <p><code>show</code> メソッドのviewはどうなっていますか。</p> <p>app/view/idea/show.html.erb</p> <div class="language-erb extra-class"><pre class="language-erb"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>notice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> notice <span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>Name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>
  <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> <span class="token variable">@idea</span><span class="token punctuation">.</span>name <span class="token delimiter punctuation">%&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">&gt;</span></span>Description:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span>
  <span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> <span class="token variable">@idea</span><span class="token punctuation">.</span>description <span class="token delimiter punctuation">%&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>


<span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> link_to <span class="token string">'Edit'</span><span class="token punctuation">,</span> edit_idea_path<span class="token punctuation">(</span><span class="token variable">@idea</span><span class="token punctuation">)</span> <span class="token delimiter punctuation">%&gt;</span></span> |
<span class="token erb language-erb"><span class="token delimiter punctuation">&lt;%=</span> link_to <span class="token string">'Back'</span><span class="token punctuation">,</span> ideas_path <span class="token delimiter punctuation">%&gt;</span></span>
</code></pre></div><p>ほとんど一目瞭然ではないでしょうか。</p> <p><code>&lt;%= @idea.name %&gt;</code> の箇所で、インスタンス変数 <code>@idea</code> のnameメソッド
を用いて <code>ideas</code>テーブルの <code>name</code>列を表示しています。</p> <h2 id="最後に"><a href="#最後に" class="header-anchor">#</a> 最後に</h2> <p>ここまででRailsを使ったアプリケーション開発のはじめの一歩を体験しまし
た。</p> <p>ほとんどコードを書かずに最低限の足場まで進むことができ、ここからアプリ
ケーションを育てていけることがなんとなくわかったのではないかと思います。</p> <p>Railsに関しては、参考になる書籍も、Webサイトも非常にたくさんあります。</p> <p>短期間でRailsを習得するためのコースもあるので、業務上必要な場合は上長
に相談して受講するのも手です。</p> <p>ただし、Railsは最初にも申し上げましたが、それなりに学習コストの高いフ
レームワークで、本格的なアプリケーションをひととおり作れるようになるた
めには数百時間の学習と実践が必要になると思われます。</p> <p>Railsは、しかし、その後のWebアプリケーション開発のお手本になった部分が
多々あり、Railsを学んでおくと、後発のWebアプリケーション開発フレームワー
クの習得が容易になるという側面もあります。</p> <p>機会を見つけて、Railsにチャレンジしてみることは、現在でも意義のあるこ
とだと思います。</p> <div><hr> <span>CC BY-SA Licensed | Copyright (c) 2019, Internet Initiative Japan Inc.</span></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/iij/bootcamp/edit/master/src/server-app/rails/README.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/2/2019, 11:26:47 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/bootcamp/assets/js/app.84399adc.js" defer></script><script src="/bootcamp/assets/js/2.acfdd0a4.js" defer></script><script src="/bootcamp/assets/js/26.f2075ce3.js" defer></script><script src="/bootcamp/assets/js/5.d20398c4.js" defer></script><script src="/bootcamp/assets/js/4.a9d4f0c2.js" defer></script>
  </body>
</html>
