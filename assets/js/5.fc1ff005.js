(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{304:function(s,t,a){s.exports=a.p+"assets/img/1.3aa529e5.png"},305:function(s,t,a){s.exports=a.p+"assets/img/2.99490071.png"},306:function(s,t,a){s.exports=a.p+"assets/img/3.db77be4f.png"},307:function(s,t,a){s.exports=a.p+"assets/img/4.494a105b.png"},308:function(s,t,a){s.exports=a.p+"assets/img/5.5af6c057.png"},309:function(s,t,a){s.exports=a.p+"assets/img/6.80e6e543.png"},310:function(s,t,a){s.exports=a.p+"assets/img/7.89be247b.png"},311:function(s,t,a){s.exports=a.p+"assets/img/8.3414d5f6.png"},312:function(s,t,a){s.exports=a.p+"assets/img/9.ba58a5cd.png"},313:function(s,t,a){s.exports=a.p+"assets/img/10.553be982.png"},314:function(s,t,a){s.exports=a.p+"assets/img/11.f0fbc580.png"},315:function(s,t,a){s.exports=a.p+"assets/img/12.761ed962.png"},316:function(s,t,a){s.exports=a.p+"assets/img/13.351d6745.png"},317:function(s,t,a){s.exports=a.p+"assets/img/14.0bf76beb.png"},318:function(s,t,a){s.exports=a.p+"assets/img/15.5a43dbca.png"},319:function(s,t,a){s.exports=a.p+"assets/img/16.1480210f.png"},320:function(s,t,a){s.exports=a.p+"assets/img/17.ea65527b.png"},321:function(s,t,a){s.exports=a.p+"assets/img/18.9fb0d6ac.png"},322:function(s,t,a){s.exports=a.p+"assets/img/19.ff9e4771.png"},323:function(s,t,a){s.exports=a.p+"assets/img/20.8371c1cf.png"},324:function(s,t,a){s.exports=a.p+"assets/img/21.f2911519.png"},523:function(s,t,a){"use strict";a.r(t);var n=a(10),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"github-actions-でciテスト・デプロイを回す"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#github-actions-でciテスト・デプロイを回す"}},[s._v("#")]),s._v(" GitHub Actions でCIテスト・デプロイを回す")]),s._v(" "),t("h1",{attrs:{id:"_0-この講義について"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-この講義について"}},[s._v("#")]),s._v(" 0. この講義について")]),s._v(" "),t("h2",{attrs:{id:"_0-1-この講義の目的"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-1-この講義の目的"}},[s._v("#")]),s._v(" 0.1 この講義の目的")]),s._v(" "),t("p",[s._v("GitHub Actions を利用したCI/CDを体験し、自分のプロジェクトにCI/CDを自ら導入できるようにする。")]),s._v(" "),t("h2",{attrs:{id:"_0-2-ハンズオンの対象者"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-2-ハンズオンの対象者"}},[s._v("#")]),s._v(" 0.2 ハンズオンの対象者")]),s._v(" "),t("ul",[t("li",[s._v("Git の操作 (clone add commit push) が行える。")]),s._v(" "),t("li",[s._v("GitHub の操作 (ログイン PRの確認 マージ)が行える。")]),s._v(" "),t("li",[s._v("YAML ファイルの編集のためテキストエディタが利用できる。")])]),s._v(" "),t("h2",{attrs:{id:"_0-3-下準備"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-3-下準備"}},[s._v("#")]),s._v(" 0.3 下準備")]),s._v(" "),t("ul",[t("li",[s._v("IIJ 社内の GHE を利用して行う場合は 別途アナウンスする手順を行う必要があります。")])]),s._v(" "),t("h2",{attrs:{id:"_0-4-この資料のお約束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-4-この資料のお約束"}},[s._v("#")]),s._v(" 0.4. この資料のお約束")]),s._v(" "),t("h3",{attrs:{id:"_0-4-1-コマンド実行の指示"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-4-1-コマンド実行の指示"}},[s._v("#")]),s._v(" 0.4.1 コマンド実行の指示")]),s._v(" "),t("p",[s._v("💻 は自分で操作する箇所を示しています。")]),s._v(" "),t("p",[s._v("例:")]),s._v(" "),t("ul",[t("li",[s._v("💻 作業用レポジトリを手元に clone してください")]),s._v(" "),t("li",[s._v("💻 以下の条件を満たすような PR を作成してください")]),s._v(" "),t("li",[s._v("💻 reviewdog による Suggested change を確認し取り込んでください")])]),s._v(" "),t("p",[s._v("🏁 は Visual Bootcamp によるチェックポイントを示しています。"),t("br"),s._v("\nうまくいったらできました！と回答ください")]),s._v(" "),t("p",[s._v("例:")]),s._v(" "),t("ul",[t("li",[s._v("🏁 チェックポイント: Repository 作成できましたか？")]),s._v(" "),t("li",[s._v("🏁 チェックポイント: マージNG -> 修正 -> マージできるようになる -> マージ の流れを体験できましたか")])]),s._v(" "),t("h3",{attrs:{id:"_0-4-2-変更が必要な箇所の明示"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-4-2-変更が必要な箇所の明示"}},[s._v("#")]),s._v(" 0.4.2 変更が必要な箇所の明示")]),s._v(" "),t("p",[s._v("<ほげほげ> で囲まれている部分は自分の設定値で置き換えてください。")]),s._v(" "),t("p",[s._v("たとえば")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("git clone <リモートリポジトリのアドレス>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("と記載されている箇所は")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("git clone git@github.com:iij/bootcamp.git\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("というように置き換えてください。")]),s._v(" "),t("h3",{attrs:{id:"_0-4-3-ファイルの変更の指示"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-4-3-ファイルの変更の指示"}},[s._v("#")]),s._v(" 0.4.3 ファイルの変更の指示")]),s._v(" "),t("ul",[t("li",[s._v("例えば 以下のような表示があれば A,B,C 3行の Bを D にしてくれ という意味です")])]),s._v(" "),t("div",{staticClass:"language-diff line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[s._v("A\n"),t("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[t("span",{pre:!0,attrs:{class:"token prefix deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("B\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("D\n")])]),s._v("C\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("table",[t("thead",[t("tr",[t("th",[s._v("変更前")]),s._v(" "),t("th",[s._v("変更後")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("A"),t("br"),s._v("B"),t("br"),s._v("C"),t("br")]),s._v(" "),t("td",[s._v("A"),t("br"),s._v("D"),t("br"),s._v("C"),t("br")])])])]),s._v(" "),t("h1",{attrs:{id:"_1-継続的インテグレーション、継続的デリバリとは"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-継続的インテグレーション、継続的デリバリとは"}},[s._v("#")]),s._v(" 1. 継続的インテグレーション、継続的デリバリとは")]),s._v(" "),t("p",[s._v("継続的インテグレーション(Continuous Integration、以下CI)とは、\nアプリケーションのリリースサイクルにおいてビルドやテストなどを自動化し、\n継続的に実行することで品質改善や納期短縮を実現するための方法です。")]),s._v(" "),t("p",[s._v("もしかしたら自分のプロジェクトがそうかもれませんが、プログラミングは意外と手作業の多い分野でした。\nしかしながら手作業でビルド、テストをしていると不具合が含まれていても発覚するのが遅くなり、手戻りが大きくなってしまいます。\nそこでビルドやテストを自動化し、コードがpushされたらすぐに実行することで早期に不具合を見つけようというのがCIです。\nまた世の中にはビルドが難しいプロダクトというのも多数存在しますので、自動化されているということは開発メンバーを追加するのも楽になります。")]),s._v(" "),t("p",[s._v("継続的デリバリ(Continuous Delivery、以下CD)とはCIをさらに進めてユーザーに製品を届けるまでのリリースプロセス全体を自動化し、\n"),t("strong",[s._v("継続的に顧客に価値を届ける")]),s._v("ことを目的とした手法です。")]),s._v(" "),t("p",[s._v("CI/CDを導入した場合、コードをコミットするとビルドが走り、ユニットテストを通して、コードがテスト環境にデプロイされます。その後結合テスト、\nシステムテストを行い、必要であれば承認後、本番環境にデプロイされます。")]),s._v(" "),t("h2",{attrs:{id:"_1-1-github-actions-とは"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-github-actions-とは"}},[s._v("#")]),s._v(" 1.1 GitHub Actions とは")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.github.com/ja/actions",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub Actions"),t("OutboundLink")],1),s._v(" とは GitHub が提供する CI/CD プラットフォームです。")]),s._v(" "),t("p",[s._v("複数の Action を組み合わせることで、 さまざまなワークフローを自動化できるようになっています。")]),s._v(" "),t("p",[s._v("Linux, Windows, macOS があらかじめ用意されているほか、"),t("br"),s._v("\nself-hosted runner と呼ばれる処理用のホストを自前で用意して、利用することもできます")]),s._v(" "),t("p",[s._v("GitHub 上の Publicリポジトリ や、 self-hosted runner を利用する場合 無料で使えます。")]),s._v(" "),t("p",[s._v("Private リポジトリでは、一部制限があるので留意ください。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.github.com/ja/billing/managing-billing-for-github-actions/about-billing-for-github-actions",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub Actionsの支払いについて"),t("OutboundLink")],1)]),s._v(" "),t("h1",{attrs:{id:"_2-まず使ってみる-simple-workflow"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-まず使ってみる-simple-workflow"}},[s._v("#")]),s._v(" 2. まず使ってみる - Simple Workflow")]),s._v(" "),t("p",[t("a",{attrs:{href:"http://github.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("github.com"),t("OutboundLink")],1),s._v(" の場合 Publicリポジトリならば特別な準備は不要です。"),t("br"),s._v(" "),t("a",{attrs:{href:"http://github.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("github.com"),t("OutboundLink")],1),s._v(" が用意しているRunnerを利用することできます")]),s._v(" "),t("p",[s._v("Github Enterprise の場合 特別な設定が必要だったり、Runner を自分で用意する必要がある場合があります。講師の案内に従ってください")]),s._v(" "),t("h2",{attrs:{id:"_2-1-レポジトリを作成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-レポジトリを作成"}},[s._v("#")]),s._v(" 2.1. レポジトリを作成")]),s._v(" "),t("p",[s._v("💻 講師の案内に従い、この講義で利用するリポジトリを作成してください"),t("br"),s._v("\nOwner の指定や、 Public/Internal/Private の 選択が大事です。")]),s._v(" "),t("p",[s._v("名前は "),t("code",[s._v("actions-test-<account名>")]),s._v(" としましょう")]),s._v(" "),t("p",[s._v("🏁 チェックポイント: Repository 作成できましたか？")]),s._v(" "),t("h2",{attrs:{id:"_2-2-simple-workflow"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-simple-workflow"}},[s._v("#")]),s._v(" 2.2. Simple workflow")]),s._v(" "),t("p",[s._v("github actions では一連の処理を workflow と呼びます。"),t("br"),s._v("\nまず、サンプルとして用意されている単純なworkflow を試してみましょう")]),s._v(" "),t("h3",{attrs:{id:"_2-2-1-workflow-ファイル配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-workflow-ファイル配置"}},[s._v("#")]),s._v(" 2.2.1. workflow ファイル配置")]),s._v(" "),t("p",[s._v("💻 作成したリポジトリにアクセスしてください\n画面上段の Actions を クリックし Simple workflow の Configure をクリックしてください\n"),t("img",{attrs:{src:a(304),alt:""}})]),s._v(" "),t("p",[s._v("すると エディタの表示になります。"),t("br"),s._v("\nファイルの中身の上に "),t("code",[s._v(".github/workflows/blank.yml")]),s._v(" と書いてあります。\nこれを "),t("code",[s._v(".github/workflows/check.yml")]),s._v(" としてください。")]),s._v(" "),t("p",[s._v("内容を変更せず 右上の Start commit ボタン を押してください"),t("br"),s._v("\nCommit new file の dialog が表示されるので"),t("br"),s._v("\nそのまま commit new file もしくは Propse new file ボタンを押してください")]),s._v(" "),t("p",[t("img",{attrs:{src:a(305),alt:""}})]),s._v(" "),t("h3",{attrs:{id:"_2-2-2-実行結果の確認"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-実行結果の確認"}},[s._v("#")]),s._v(" 2.2.2. 実行結果の確認")]),s._v(" "),t("p",[s._v("💻 その後 もう一度 画面上段の Actions をクリックしてください")]),s._v(" "),t("p",[s._v("すると All workflows の表示になると思います。\n"),t("img",{attrs:{src:a(306),alt:""}})]),s._v(" "),t("p",[s._v("画像の Create blank.yml の左が 緑色のチェックアイコンになっています。"),t("br"),s._v("\nこれは workflow の成功を意味します。"),t("br"),s._v("\nもし、ここで 赤色のバツ印 になっているとうまくいっていません。"),t("br"),s._v("\n何が悪いかはその表示だけではわからないので、詳しく見る必要があります。")]),s._v(" "),t("p",[s._v("💻 どちらの場合も Create blank.yml をクリックしてください\n"),t("img",{attrs:{src:a(307),alt:""}})]),s._v(" "),t("p",[s._v("すると 実行結果をより詳しく見ることができます。"),t("br"),s._v("\n実際に処理されるコマンド列などを step とよび、 一連のstep を job という単位でまとめることができます。"),t("br"),s._v("\nworkflow は 複数のjob で構成できますが、 simple workflow は build という job しかありません。")]),s._v(" "),t("p",[s._v("💻 それでは 画面左 もしくは 画面中央の build をクリックして job の結果を見てみましょう")]),s._v(" "),t("p",[t("img",{attrs:{src:a(308),alt:""}})]),s._v(" "),t("p",[s._v("画像にある Run a one-line script などは step です。"),t("br"),s._v("\nこの job の結果画面では step ごとに どのような処理がされたか確認できます。")]),s._v(" "),t("p",[s._v("先程の workflow の実行結果画面で 赤色のバツ印が出ていた人は エラーの表示を確認できると思うので、そのエラーを読んでみてください。")]),s._v(" "),t("p",[s._v("🏁 チェックポイント: Simple Workflow が動きましたか？")]),s._v(" "),t("h2",{attrs:{id:"_2-3-simple-workflow-のアレンジ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-simple-workflow-のアレンジ"}},[s._v("#")]),s._v(" 2.3. Simple Workflow のアレンジ")]),s._v(" "),t("p",[s._v("ここまでで、 Github Actions を利用して処理を行えるようになりました。")]),s._v(" "),t("p",[s._v("それでは、簡単なチェックを足していきます。")]),s._v(" "),t("h3",{attrs:{id:"_2-3-1-github-actions-の文法を知る"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-github-actions-の文法を知る"}},[s._v("#")]),s._v(" 2.3.1. Github Actions の文法を知る")]),s._v(" "),t("p",[s._v("Simple Workflow の 設定を読んでみましょう\nレポジトリの "),t("code",[s._v(".github/workflows/blank.yml")]),s._v(" が作成されているはずです。\n以下は 執筆時に github enterprise で作成したときのものです。\nバージョンによって違いがあるかもしれませんが、違いに注目しながら読んでみてください。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This is a basic workflow to help you get started with Actions")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" CI  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <---  表示名。 重複もゆるされてしまうので わかり易い名前にしましょう")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Controls when the workflow will run")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <--- どんなときに実行するか指定します。")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# Triggers the workflow on push or pull request events but only for the "main" branch')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("push")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branches")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <--- 今回は main branch への push か")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pull_request")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branches")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <--- 今回は main branch への Pull Request にしてあります")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Allows you to run this workflow manually from the Actions tab")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("workflow_dispatch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <--- 手動で実行化")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# A workflow run is made up of one or more jobs that can run sequentially or in parallel")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# This workflow contains a single job called "build"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <--- job 名なので好きに変えられる")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The type of runner that the job will run on")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runs-on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("hosted "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <--- どんな runner で実行するか")]),s._v("\n                             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#      例えば OS version など指定できる場合もあり")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Steps represent a sequence of tasks that will be executed as part of the job")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("steps")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<--- job には step がある。 この表記は固定")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/checkout@v3 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <--- git checkout を行う")]),s._v("\n\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Runs a single command using the runners shell")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Run a one"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("line script "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<--- step の 名前 省略可")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" echo Hello"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" world"),t("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<--- 実行するコマンド")]),s._v("\n\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Runs a set of commands using the runners shell")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Run a multi"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("line script\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#<--- もし複数書きたいときはこのようにかける")]),s._v("\n          echo Add other actions to build"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          echo test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" and deploy your project.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br")])]),t("h3",{attrs:{id:"_2-3-2-アレンジしてみる"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-2-アレンジしてみる"}},[s._v("#")]),s._v(" 2.3.2. アレンジしてみる")]),s._v(" "),t("p",[s._v("それでは、 上の処理に加えて以下追加してみましょう")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("main")]),s._v(" branch だけでなく、すべての場合でチェックするように")]),s._v(" "),t("li",[s._v("job 名を "),t("code",[s._v("build")]),s._v(" じゃなくて "),t("code",[s._v("checkname")]),s._v(" へ")]),s._v(" "),t("li",[t("code",[s._v("name: CI")]),s._v(" から書き換えてあるかチェック")])]),s._v(" "),t("p",[s._v("変更内容は 以下のとおりです。")]),s._v(" "),t("h4",{attrs:{id:"処理対象をすべての場合に"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#処理対象をすべての場合に"}},[s._v("#")]),s._v(" 処理対象をすべての場合に")]),s._v(" "),t("div",{staticClass:"language-diff line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("on:\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v('  # Triggers the workflow on push or pull request events but only for the "main" branch\n')]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("  push:\n")])]),t("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[t("span",{pre:!0,attrs:{class:"token prefix deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v('    branches: [ "main" ]\n')])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v('    branches: [ "*" ]\n')])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("  pull_request:\n")])]),t("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[t("span",{pre:!0,attrs:{class:"token prefix deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v('    branches: [ "main" ]\n')])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v('    branches: [ "*" ]\n')])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("  # Allows you to run this workflow manually from the Actions tab\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("  workflow_dispatch:\n")])])])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h4",{attrs:{id:"job-名を変更"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#job-名を変更"}},[s._v("#")]),s._v(" job 名を変更")]),s._v(" "),t("div",{staticClass:"language-diff line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("# A workflow run is made up of one or more jobs that can run sequentially or in parallel\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("jobs:\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v('  # This workflow contains a single job called "build"\n')])]),t("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[t("span",{pre:!0,attrs:{class:"token prefix deleted"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("  build:\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("  checkname:\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("    # The type of runner that the job will run on\n")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h4",{attrs:{id:"環境変数と-name-変更漏れチェック"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#環境変数と-name-変更漏れチェック"}},[s._v("#")]),s._v(" 環境変数と name 変更漏れチェック")]),s._v(" "),t("div",{staticClass:"language-diff line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("      - name: Run a multi-line script\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("        run: |\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("          echo Add other actions to build,\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("          echo test, and deploy your project.\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("      - name: Print environments\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("        run: env\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("      - name: Check workflow name modified?\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("        run: |\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("          bash -c \"grep '^name: CI' .github/workflows/*.yml;test \\${?} -eq 1\"\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("\n")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("上記変更点を 取り込むPR を作成していきましょう。")]),s._v(" "),t("h2",{attrs:{id:"_2-4-変更を-commit-して-pull-request-を作る"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-変更を-commit-して-pull-request-を作る"}},[s._v("#")]),s._v(" 2.4. 変更を commit して Pull Request を作る")]),s._v(" "),t("p",[s._v("それでは、修正をしていくのですが、今回は Pull Request を作ります。")]),s._v(" "),t("p",[s._v("別のbranch に push した内容を develop branch などへ取り込んでもらうためのリクエストを Pull Request(PR) と呼びます。")]),s._v(" "),t("h3",{attrs:{id:"_2-4-1-変更をcommit"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-1-変更をcommit"}},[s._v("#")]),s._v(" 2.4.1. 変更をcommit")]),s._v(" "),t("p",[s._v("💻 以下の通り PullRequest のため 別branch に commit しましょう")]),s._v(" "),t("p",[s._v("ブラウザで"),t("code",[s._v("check.yml")]),s._v(" を 開いて 右上の 鉛筆マークから 内容の変更ができます。\n"),t("img",{attrs:{src:a(309),alt:""}})]),s._v(" "),t("p",[s._v("このとき indent (左からどのぐらい空白があるか) を揃えるようにしてください")]),s._v(" "),t("p",[s._v("なお、変更後 右上のstart commit ボタンから\n"),t("code",[s._v("Create a new branch for this commit and start a pull request.")]),s._v("　を選択した上で Propose changes するようにしてください")]),s._v(" "),t("p",[t("img",{attrs:{src:a(310),alt:""}})]),s._v(" "),t("p",[s._v("うまくいくと PR を作成する画面に移動します。")]),s._v(" "),t("h3",{attrs:{id:"_2-4-2-pullrequest-を作成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-2-pullrequest-を作成"}},[s._v("#")]),s._v(" 2.4.2. PullRequest を作成")]),s._v(" "),t("p",[s._v("💻 以下の通り PullRequest を作成しましょう")]),s._v(" "),t("p",[s._v("PullRequest は 自分が書き込み権限を持っていないレポジトリに対して、修正を取り込んでもらうために利用する事が多いです。")]),s._v(" "),t("p",[s._v("そのため、もし、作業リポジトリを fork して作成した場合 は PR の送り先が fork 元 repository になっています。")]),s._v(" "),t("p",[s._v("PullRequest を作成するときは、base repository (左側) の 表記を見直してください。")]),s._v(" "),t("p",[s._v("今回は 自分のrepository に対して行うので、 画像の通り "),t("code",[s._v("base: main")]),s._v(" で良いです。")]),s._v(" "),t("p",[s._v("タイトルは "),t("code",[s._v("環境変数の表示と name 変更チェックを追加")]),s._v(" にしましょう\n本文には、内容の簡単な説明や、経緯などを書くのが普通ですが、今回は自由です。")]),s._v(" "),t("p",[s._v("入力したら Create pull request ボタンを押しましょう")]),s._v(" "),t("p",[t("img",{attrs:{src:a(311),alt:""}})]),s._v(" "),t("p",[s._v("しばらくすると 茶色で "),t("code",[s._v("Some checks haven't completed yet")]),s._v(" と表示されたあと")]),s._v(" "),t("p",[t("code",[s._v("All checks have failed")]),s._v(" として失敗とされます。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(312),alt:""}})]),s._v(" "),t("p",[s._v("画像の通り")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("CI / checkname (pull_request) Failing after 6s — build \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("が表示されていれば Details をクリックしてください。 ジョブの詳細画面に飛びます。")]),s._v(" "),t("p",[s._v("以下のように "),t("code",[s._v("name: CI")]),s._v(" のままなので Error となっていれば うまく仕込めたことになります。\n"),t("img",{attrs:{src:a(313),alt:""}})]),s._v(" "),t("p",[s._v("🏁 チェックポイント: 仕込んだチェッカーでうまくエラーになりましたか？")]),s._v(" "),t("h3",{attrs:{id:"_2-4-3-マージ禁止設定"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-3-マージ禁止設定"}},[s._v("#")]),s._v(" 2.4.3. マージ禁止設定")]),s._v(" "),t("p",[s._v("これで "),t("code",[s._v("name: CI")]),s._v(" を変更し忘れても気付けるようになりました。"),t("br"),s._v("\nが、このままでは NG なのに "),t("code",[s._v("Merge pull request")]),s._v(" ボタンで マージできてしまいます。")]),s._v(" "),t("p",[s._v("CI によるテストが全部OKでないとマージできないようにしましょう。")]),s._v(" "),t("p",[s._v("GitHubの設定画面から変更できます。")]),s._v(" "),t("p",[s._v("💻 テストが通ったときだけマージできるように設定してみましょう")]),s._v(" "),t("ol",[t("li",[s._v("「Settings」->「Branches」->「Branch protection rules」->「Add rule」を押し、")]),s._v(" "),t("li",[s._v("「Branch name pattern」に「main」と記入し、")]),s._v(" "),t("li",[s._v("「Do not allow bypassing the above settings」にチェックを入れます。")]),s._v(" "),t("li",[s._v("「Require status checks to pass before merging」にチェックを入れて")]),s._v(" "),t("li",[s._v("「Status checks found in the last week for this repository」の検索窓に「checkname」と入力して選択")]),s._v(" "),t("li",[s._v("「Create」します。")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(314),alt:""}})]),s._v(" "),t("p",[s._v("するともうマージボタンは押せなくなっています。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(315),alt:""}})]),s._v(" "),t("h3",{attrs:{id:"_2-4-4-マージする。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-4-マージする。"}},[s._v("#")]),s._v(" 2.4.4. マージする。")]),s._v(" "),t("p",[s._v("💻 check.yml の name を CI から変更し、マージしてみてください")]),s._v(" "),t("p",[t("img",{attrs:{src:a(316),alt:""}})]),s._v(" "),t("p",[s._v("🏁 チェックポイント: マージNG -> 修正 -> マージできるようになる -> マージ の流れを体験できましたか")]),s._v(" "),t("h1",{attrs:{id:"_3-応用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-応用"}},[s._v("#")]),s._v(" 3. 応用")]),s._v(" "),t("h2",{attrs:{id:"_3-1-reviewdog-black"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-reviewdog-black"}},[s._v("#")]),s._v(" 3.1. reviewdog + black")]),s._v(" "),t("p",[s._v("Github の PR には "),t("a",{attrs:{href:"https://docs.github.com/ja/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/incorporating-feedback-in-your-pull-request",target:"_blank",rel:"noopener noreferrer"}},[s._v("Suggested changes"),t("OutboundLink")],1),s._v(" と呼ばれる機能があります。")]),s._v(" "),t("p",[s._v("PR では 変更点に対して1行ずつコメントする機能があります\nそれで、コードの内容について、質問しあったり、より良くするために提案をすることをコードレビューと呼びます。")]),s._v(" "),t("p",[s._v("その時に便利な機能です。")]),s._v(" "),t("p",[s._v("具体的にコードをどのように変えたら良いと思うか提案でき、\n提案された内容は、ブラウザ上の操作で簡単に取り込むことができます。\n"),t("img",{attrs:{src:a(317),alt:""}})]),s._v(" "),t("p",[s._v("コードの考え方や、仕様の捉え方のすり合わせなどのやり取りに注意を払うため、"),t("br"),s._v("\n単純に修正ができるコードスタイルの変更については 機械的に自動で行わせましょう。")]),s._v(" "),t("p",[s._v("今回は、pythonのフォーマッタである"),t("a",{attrs:{href:"https://github.com/psf/black",target:"_blank",rel:"noopener noreferrer"}},[s._v("black"),t("OutboundLink")],1),s._v("と\nツールの処理結果をPRにコメントができる"),t("a",{attrs:{href:"https://github.com/reviewdog/reviewdog",target:"_blank",rel:"noopener noreferrer"}},[s._v("reviewdog"),t("OutboundLink")],1),s._v("を使い")]),s._v(" "),t("p",[s._v("コードの見た目をきれいにするような Suggested changes をするようにします。")]),s._v(" "),t("p",[s._v("例えば、以下のような ファイルを置いてみると")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .github/workflows/reviewdog_black.yml")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" reviewdog\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("pull_request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("black")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runs-on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("hosted "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("steps")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/checkout@v2\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/setup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("python@v4\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("python-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.10'")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pip install black\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" do black\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" black .\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" get reviewdog\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token scalar string"}},[s._v("\n          curl -sfL https://raw.githubusercontent.com/reviewdog/reviewdog/master/install.sh | sh -s\n          ./bin/reviewdog -version")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# by https://github.com/reviewdog/action-suggester/tree/master")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" get diff\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token scalar string"}},[s._v('\n          TMPFILE=$(mktemp)\n          git diff > "${TMPFILE}"\n          export REVIEWDOG_GITHUB_API_TOKEN="${{ secrets.GITHUB_TOKEN }}"\n          ./bin/reviewdog \\\n          -f diff \\\n          -f.diff.strip=1 \\\n          -reporter="github-pr-review" \\\n          -filter-mode="diff_context" \\\n          -fail-on-error="true" \\\n          -level="warning"  <"${TMPFILE}"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ng_format.py")]),s._v("\na"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nb"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aaaa"')]),s._v("\nc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'aaaa'")]),s._v("\nd"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ne "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("b\n        \n        \n        \n        \n        \n              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("このように 変更点が提案され\n"),t("img",{attrs:{src:a(318),alt:""}})]),s._v(" "),t("p",[s._v("CI の Check も NG であるとされます。\n"),t("img",{attrs:{src:a(319),alt:""}})]),s._v(" "),t("p",[s._v("つまり、 この reviewdog/black テストを マージ時必須とすれば、フォーマットを整えたコードだけが取り込めるようになりそうです。")]),s._v(" "),t("p",[s._v("🏁 応用: 時間があれば試してみてください!")]),s._v(" "),t("h2",{attrs:{id:"_3-2-danger-github"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-danger-github"}},[s._v("#")]),s._v(" 3.2. danger + github")]),s._v(" "),t("p",[s._v("今回 PullRequest を作成し、 その内容をgithub actions でチェックすることで、\n良くないコードが取り込まれるのを防ぐやり方を学びました。")]),s._v(" "),t("p",[s._v("では、コードだけでなく、 PullRequest のタイトルや、説明書き、label などを確認したいときはどうすればよいでしょうか。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/danger/danger",target:"_blank",rel:"noopener noreferrer"}},[s._v("danger"),t("OutboundLink")],1),s._v("というツールは 非常に様々なプラグインがあり、github の plugin を利用することで")]),s._v(" "),t("ul",[t("li",[s._v("PR の タイトル")]),s._v(" "),t("li",[s._v("PR の 説明文")]),s._v(" "),t("li",[s._v("PR の ラベル")]),s._v(" "),t("li",[s._v("PR の 著者")]),s._v(" "),t("li",[s._v("PR の 説明文の行数")]),s._v(" "),t("li",[s._v("PR の merge 先の branch 名\nなどの情報を利用してチェックできるようになります。")])]),s._v(" "),t("p",[s._v("以下のようなファイルを用意します。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .github/workflows/danger_github.yml")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" danger\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pull_request")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("types")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" assigned\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" unassigned\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" labeled\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" unlabeled\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" opened\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" edited\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" closed\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" reopened\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" synchronize\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" converted_to_draft\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ready_for_review\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" locked\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" unlocked\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" review_requested\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" review_request_removed\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" auto_merge_enabled\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" auto_merge_disabled\n    \n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("github")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runs-on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("hosted "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("steps")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/checkout@v2\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ruby/setup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ruby@v1\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ruby-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.0'")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gem install danger\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" danger\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("DANGER_GITHUB_API_BASE_URL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${{ github.api_url }}"')]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("DANGER_GITHUB_API_TOKEN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"${{ secrets.GITHUB_TOKEN }}"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" danger\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br")])]),t("div",{staticClass:"language-ruby line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Dangerfile")]),s._v("\nmessage "),t("span",{pre:!0,attrs:{class:"token string-literal"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Welcome, ')]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[s._v("#{")]),t("span",{pre:!0,attrs:{class:"token content"}},[s._v("github"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pr_author")]),t("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('."')])]),s._v("\n\nwarn "),t("span",{pre:!0,attrs:{class:"token string-literal"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PR is classed as Work in Progress"')])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" github"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pr_title"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string-literal"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[WIP]"')])]),s._v("\n\nfailure "),t("span",{pre:!0,attrs:{class:"token string-literal"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"This PR does not have any assignees yet."')])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" github"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pr_json"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string-literal"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"assignee"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("すると、以下のように")]),s._v(" "),t("ol",[t("li",[s._v("誰が作ったPR なのかわかるコメント")]),s._v(" "),t("li",[s._v("アサインが誰もいないので failure")]),s._v(" "),t("li",[s._v("[WIP] で始まってるので warn")])]),s._v(" "),t("p",[s._v("のようなコメントがされる")]),s._v(" "),t("p",[t("img",{attrs:{src:a(320),alt:""}}),s._v(" "),t("img",{attrs:{src:a(321),alt:""}})]),s._v(" "),t("p",[s._v("ここで、")]),s._v(" "),t("p",[s._v("自身をとりあえずself-assign してみると コメントが更新され check OK に")]),s._v(" "),t("p",[t("img",{attrs:{src:a(322),alt:""}})]),s._v(" "),t("p",[s._v("[WIP] を外すと更に、 warn が消えた\n"),t("img",{attrs:{src:a(323),alt:""}})]),s._v(" "),t("p",[s._v("アサインしたり、件名を変えたりするたびに github actions が動いており、それにより更新された\n"),t("img",{attrs:{src:a(324),alt:""}})]),s._v(" "),t("p",[s._v("このように、 PR の内容だけでなく、 PR それ自体についての情報を利用したテストも書くことができる。")]),s._v(" "),t("p",[s._v("これをうまく使えば、ルールに従ったPRを運用できる")]),s._v(" "),t("p",[s._v("🏁 応用: 時間があれば試してみてください!")]),s._v(" "),t("h1",{attrs:{id:"_4-github-actions-の-基本的な設定"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-github-actions-の-基本的な設定"}},[s._v("#")]),s._v(" 4. GitHub Actions の 基本的な設定")]),s._v(" "),t("p",[s._v("github actions は 複数の step からなる Workflow を作成できるようになっています。")]),s._v(" "),t("p",[s._v("github actions の最大の特徴は Action と呼ばれる再利用可能なコードを組み合わせることで、簡単にさまざまなことができるようになっている点です。")]),s._v(" "),t("p",[s._v("GitHub Actions にはさまざまな設定項目があります。")]),s._v(" "),t("p",[s._v("他詳細は"),t("a",{attrs:{href:"https://docs.github.com/ja/actions/using-workflows/workflow-syntax-for-github-actions",target:"_blank",rel:"noopener noreferrer"}},[s._v("公式ドキュメント"),t("OutboundLink")],1),s._v(" を参照ください。")]),s._v(" "),t("h2",{attrs:{id:"_4-1-name-on"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-name-on"}},[s._v("#")]),s._v(" 4.1. name, on")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" CI\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("push"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[t("p",[t("code",[s._v("name")]),s._v(" - このファイルで実現されるものについての名前です。")]),s._v(" "),t("p",[t("code",[s._v(".github/workflows")]),s._v(" 以下に複数のファイルを置くことが可能です。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("on")]),s._v(" - ワークフローがいつ実行されるかの定義です。")]),s._v(" "),t("p",[s._v("特定の branch に対する操作のときだけに限定したりも可能ですが、"),t("br"),s._v("\n今回は push すべてを対象にしています。")])])]),s._v(" "),t("h2",{attrs:{id:"_4-2-jobs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-jobs"}},[s._v("#")]),s._v(" 4.2. jobs")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rspec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runs-on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("latest\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("steps")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/checkout@v2\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ruby/setup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ruby@v1\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ruby-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2.6'")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("bundler-cache")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" bundle exec rspec\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("jobs は job の集合体です。job は ワークフローの実行単位で必ず1つ以上含まれます。")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("rspec")]),s._v(" というのが この job の 識別子になります。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("runs-on")]),s._v(" - どんなタイプのマシンで このジョブを実行したいかを指定します。")]),s._v(" "),t("p",[s._v("自前でランナーを用意する場合は "),t("code",[s._v("self-hosted")]),s._v(" と指定したり、"),t("br"),s._v(" "),t("a",{attrs:{href:"http://GitHub.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub.com"),t("OutboundLink")],1),s._v(" が用意するものを利用する場合は "),t("code",[s._v("ubuntu-latest")]),s._v(" などと指定します。"),t("br"),s._v("\nほかにも Windows や macOS を選択できます。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("steps")]),s._v(" - job の実際の操作を記述する部分です。"),t("br"),s._v(" "),t("code",[s._v("uses")]),s._v(" や "),t("code",[s._v("run")]),s._v(" などで実際にどんな操作をするか定義できます。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("run")]),s._v(" - コマンドを実行します。"),t("br"),s._v("\nコマンドは、デフォルトでは非ログインシェルを使用して実行されます。"),t("br"),s._v("\nyaml の "),t("code",[s._v("|")]),s._v(" を利用して複数行実行することや、"),t("br"),s._v(" "),t("code",[s._v("working-directory")]),s._v(" を指定して特定のディレクトリで実行させることも可能です。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("uses")]),s._v(" - action を実行します。")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("actions/checkout@v2")]),t("br"),s._v("\nGit checkout をします。 Git repository の内容について処理する場合はこれが必要です。")]),s._v(" "),t("li",[t("code",[s._v("ruby/setup-ruby@v1")]),t("br"),s._v("\nRuby をインストールします。 このあとの "),t("code",[s._v("run")]),s._v(" では Ruby のコマンドを利用できます。")])]),s._v(" "),t("p",[s._v("また、 一部 "),t("code",[s._v("with")]),s._v(" で パラメータを与えられるものもあります。"),t("br"),s._v("\n(Ruby のバージョンを3にしてみるのもよいですね。)")]),s._v(" "),t("p",[s._v("なお、 この action の @v2 や @v1 は branch や tag などの Git 的 refs を意味します。"),t("br"),s._v("\nつまり、 GitHub 上の ある repository の内容を利用しているということです。"),t("br"),s._v("\nそのため、 repository 側の更新により、意図せず振る舞いが変わる可能性があります。")])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),t("p",[s._v("公式でも「リリースされたアクションバージョンのコミットSHAを使用するのが、安定性とセキュリティのうえで最も安全です。」としています。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.github.com/ja/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idstepsuses",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.github.com/ja/actions/using-workflows/workflow-syntax-for-github-actions#jobsjob_idstepsuses"),t("OutboundLink")],1)])]),s._v(" "),t("h1",{attrs:{id:"_5-ほかにも"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-ほかにも"}},[s._v("#")]),s._v(" 5. ほかにも")]),s._v(" "),t("p",[s._v("GitHub Actions の最大の特徴は action を組み合わせて workflow を実現できる点でした。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/marketplace",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/marketplace"),t("OutboundLink")],1),s._v(" では さまざまな action を探すことができます")]),s._v(" "),t("p",[s._v("さらには 自分で action を作ることも可能です。")]),s._v(" "),t("p",[s._v("いろいろ探してみてください。")]),s._v(" "),t("p",[s._v("ちなみに、この資料も GitHub Actions で作られています。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/iij/bootcamp/actions",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/iij/bootcamp/actions"),t("OutboundLink")],1),t("br"),s._v(" "),t("a",{attrs:{href:"https://github.com/iij/bootcamp/tree/master/.github/workflows",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/iij/bootcamp/tree/master/.github/workflows"),t("OutboundLink")],1)]),s._v(" "),t("h1",{attrs:{id:"_6-参考情報"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-参考情報"}},[s._v("#")]),s._v(" 6. 参考情報")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.github.com/ja/actions",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub Actions"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);