(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{534:function(s,a,t){"use strict";t.r(a);var e=t(16),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"_3-ansible-playbook-の作成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-ansible-playbook-の作成"}},[s._v("#")]),s._v(" 3. Ansible playbook の作成")]),s._v(" "),a("p",[s._v("先ほどの項で発展演習を行った人は既にansible を使ってホストの操作を行いました。\nしかし、Ansible のアドホックコマンドは単純なオペレーションには便利ですが、\n複雑な構成管理や作業の定型化などには適していません。\nAnsible の真価を発揮するためには、Playbook の使用方法を学習し、一連のターゲットホストに対して複数の複雑なタスクを簡単に反復可能な方法で実行できるようにする必要があります。")]),s._v(" "),a("p",[s._v("この章では、Ansible Playbookの基本概念と作成方法、実行方法について学びます。"),a("br"),s._v("\nPlaybookを使うことで、複雑な構成管理や定型作業を効率的に自動化できます。")]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"playbookとは"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#playbookとは"}},[s._v("#")]),s._v(" Playbookとは？")]),s._v(" "),a("p",[s._v("Ansible Playbookは、YAML形式で記述する一連のタスクの集合です。"),a("br"),s._v("\nサーバーの設定、アプリケーションのデプロイ、タスクの実行などを自動化できます。")]),s._v(" "),a("p",[s._v("主な構成要素：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("Play")]),s._v(": 実行するタスクの集合。対象ホストやタスクの順序を定義します。")]),s._v(" "),a("li",[a("strong",[s._v("Task")]),s._v(": 実行する具体的な操作。モジュールを使用してタスクを実行します。")]),s._v(" "),a("li",[a("strong",[s._v("Module")]),s._v(": 実際にタスクを実行するためのスクリプト。Ansibleには多くの標準モジュールが含まれています。")]),s._v(" "),a("li",[a("strong",[s._v("Handler")]),s._v(": 特定の条件が満たされた場合に実行されるタスク。サービスの再起動などに使用します。")]),s._v(" "),a("li",[a("strong",[s._v("Variable")]),s._v(": タスク内で使用される動的な値。Playbook内や外部ファイルから定義できます。")])]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"playbookの基本構造"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#playbookの基本構造"}},[s._v("#")]),s._v(" Playbookの基本構造")]),s._v(" "),a("p",[s._v("Playbookは、管理対象に対して「こうなってほしい」という構成や手順を記述したファイルです。"),a("br"),s._v("\n複数のタスクを順序通りに実行でき、再利用や定型化に適しています。")]),s._v(" "),a("h2",{attrs:{id:"演習-3-ansible-playbookの作成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#演習-3-ansible-playbookの作成"}},[s._v("#")]),s._v(" [演習.3] Ansible Playbookの作成")]),s._v(" "),a("ul",[a("li",[s._v("Ansibleのplaybookを作成します。今回は"),a("code",[s._v("playbook.yml")]),s._v("として作成してみます\n"),a("ul",[a("li",[s._v("docker 上で作成する場合は以下の通りvi 等でテキストファイルを作成します")]),s._v(" "),a("li",[s._v("演習環境に沿って実施している人は ansible フォルダがそのままconsoleホストにマウントされているため、ansibleフォルダ配下にファイルを作成しvscodeで編集することが可能です")])])]),s._v(" "),a("li",[s._v("playbook.ymlの作成\n"),a("ul",[a("li",[s._v("以下のように記載します"),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" exercise\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tasks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])])]),s._v(" "),a("li",[s._v("playbookの実行\n"),a("ul",[a("li",[s._v("Playbookの実行には"),a("code",[s._v("ansible-plyabook")]),s._v("というコマンドを使って実行します"),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ansible-playbook "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" inventories/hosts playbooks.yml "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-k")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[s._v("実行結果"),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("SSH password:\n\nPLAY "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("exercise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ***********************************************************************************************************\n\nTASK "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Gathering Facts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ****************************************************************************************************\nok: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("host00"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nok: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("host01"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nTASK "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ***************************************************************************************************************\nok: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("host01"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nok: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("host00"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nPLAY RECAP ****************************************************************************************************************\nhost00                     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ok")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("changed")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("unreachable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("failed")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("skipped")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rescued")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ignored")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nhost01                     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ok")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("changed")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("unreachable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("failed")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("skipped")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rescued")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ignored")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   ```\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])])])])])]),s._v(" "),a("p",[s._v("上記の通り exercise グループに属している host00, host01, の 2 台に対し、ping モジュールが実行され"),a("code",[s._v("OK")]),s._v("が表示されれば成功です。")]),s._v(" "),a("h3",{attrs:{id:"参考-playbook解説"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考-playbook解説"}},[s._v("#")]),s._v(" 参考: playbook解説")]),s._v(" "),a("ul",[a("li",[s._v("1 行目: "),a("code",[s._v("---")]),s._v(" "),a("ul",[a("li",[s._v("Playbook の始まりを意味します")]),s._v(" "),a("li",[s._v("YAML における形式の区切りの意味も持つため Playbook を書く際には必ず入れましょう")])])]),s._v(" "),a("li",[s._v("2 行目 "),a("code",[s._v("hosts: exercise")]),s._v(" "),a("ul",[a("li",[s._v("この Playbook（Play）は、Inventory の中の"),a("code",[s._v("exercise")]),s._v("グループに対して実行すると示します")])])]),s._v(" "),a("li",[s._v("4 行目 "),a("code",[s._v("tasks:")]),s._v(" "),a("ul",[a("li",[s._v("この行以下は、この Playbook（Play）で実行される task を定義します")]),s._v(" "),a("li",[s._v("tasks 後の行は、インデント（行頭の空白による字下げ）が入ります\n"),a("ul",[a("li",[s._v("このインデントは、YAML の書式同様、以降の要素が tasks の子要素や孫要素となっていることを意味します")])])])])]),s._v(" "),a("li",[s._v("5 行目 "),a("code",[s._v("ping")]),s._v(" "),a("ul",[a("li",[s._v("ここで"),a("code",[s._v("ping")]),s._v("モジュールを用いて操作する事（task)を宣言します\n"),a("ul",[a("li",[s._v("モジュールによって様々なオプションを追加することがあります")])])])])])]),s._v(" "),a("h2",{attrs:{id:"発展演習-1-dry-run-変更内容の確認"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#発展演習-1-dry-run-変更内容の確認"}},[s._v("#")]),s._v(" [発展演習.1] dry-run（変更内容の確認）")]),s._v(" "),a("p",[s._v("Playbookを実行する前に、実際に変更が行われるかどうかを確認するためにdry-run（チェックモード）を行います。")]),s._v(" "),a("ul",[a("li",[s._v("既に作成済みの "),a("code",[s._v("playbook.yml")]),s._v(" を使用します。")]),s._v(" "),a("li",[s._v("以下のコマンドでPlaybookをdry-runモードで実行します。"),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ansible-playbook "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" inventories/hosts playbooks.yml "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--check")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-k")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[s._v("dry-runの実行結果例"),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("PLAY [exercise] *******************************************************************\n\nTASK [pingモジュールで疎通確認] ****************************************************\nok: [host00]\nok: [host01]\n\nPLAY RECAP ***********************************************************************\nhost00                     : ok=1    changed=0    unreachable=0    failed=0\nhost01                     : ok=1    changed=0    unreachable=0    failed=0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])]),s._v(" "),a("li",[s._v("dry-runの結果を確認し、実際に変更が行われるかどうかを事前に把握できます。")])]),s._v(" "),a("h2",{attrs:{id:"発展演習-2-gather-factsの停止"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#発展演習-2-gather-factsの停止"}},[s._v("#")]),s._v(" [発展演習.2] gather_factsの停止")]),s._v(" "),a("p",[s._v("Playbook実行時、デフォルトでホスト情報（facts）が収集されますが、不要な場合は収集を停止できます。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("gather_facts: false")]),s._v(" を指定したPlaybook例")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" exercise\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gather_facts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tasks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pingモジュールで疎通確認\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("実行コマンド")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ansible-playbook "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" inventories/hosts playbooks.yml "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-k")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("実行結果例")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("PLAY [exercise] *******************************************************************\n\nTASK [pingモジュールで疎通確認] ****************************************************\nok: [host00]\nok: [host01]\n\nPLAY RECAP ***********************************************************************\nhost00                     : ok=1    changed=0    unreachable=0    failed=0\nhost01                     : ok=1    changed=0    unreachable=0    failed=0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("実行結果では "),a("code",[s._v("TASK [Gathering Facts]")]),s._v(" が表示されず、すぐにタスクが実行されます。")])])]),s._v(" "),a("h2",{attrs:{id:"発展演習-3-対象ホストの絞り込み"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#発展演習-3-対象ホストの絞り込み"}},[s._v("#")]),s._v(" [発展演習.3] 対象ホストの絞り込み")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("特定のホストグループに対してのみタスクを実行します")])]),s._v(" "),a("li",[a("p",[s._v("以下の内容でインベントリファイルを作成します。")]),s._v(" "),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token section"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("exercise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\nhost00\nhost01\n"),a("span",{pre:!0,attrs:{class:"token section"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("web")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\nweb00\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("以下の内容でPlaybookを作成します。")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Webサーバーに対するタスク\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" web\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tasks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pingモジュールで疎通確認\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("以下のコマンドでPlaybookを実行します。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("ansible-playbook "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" inventories/hosts playbooks.yml "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-k")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("実行結果では インベントリファイルで "),a("code",[s._v("web")]),s._v(" グループに属するホスト（例: "),a("code",[s._v("web00")]),s._v("）のみがPlaybookの実行対象となる為、実行結果は以下のようになります")]),s._v(" "),a("div",{staticClass:"language-text line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("PLAY [Webサーバーに対するタスク] ***************************************************\n\nTASK [pingモジュールで疎通確認] ****************************************************\nok: [web00]\n\nPLAY RECAP ***********************************************************************\nweb00                     : ok=1    changed=0    unreachable=0    failed=0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("exercise")]),s._v(" グループの "),a("code",[s._v("host00")]),s._v(" や "),a("code",[s._v("host01")]),s._v(" にはタスクが実行されません。")])]),s._v(" "),a("li",[a("p",[s._v("指定したグループ（web）のホストだけに対して、pingモジュールが実行され、"),a("code",[s._v("ok")]),s._v("が表示されれば成功です。")])])]),s._v(" "),a("credit-footer")],1)}),[],!1,null,null,null);a.default=n.exports}}]);