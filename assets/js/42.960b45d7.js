(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{515:function(s,a,e){"use strict";e.r(a);var n=e(10),t=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"ansible-とは"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-とは"}},[s._v("#")]),s._v(" Ansible とは")]),s._v(" "),a("p",[s._v("Ansibleは、IT環境の自動化を実現する強力なオープンソースツールです。システム構成管理、アプリケーションデプロイ、タスク実行、オーケストレーションなど、幅広い用途で活用されています。Ansibleの最大の特徴は、シンプルさと柔軟性を兼ね備えていることです。YAMLという人間にも読みやすい形式で設定を記述でき、学習曲線が緩やかなため、初心者でも比較的短期間で習得できます。")]),s._v(" "),a("p",[s._v("Ansible docs: "),a("a",{attrs:{href:"https://docs.ansible.com/ansible/latest/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.ansible.com/ansible/latest/index.html"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Ansible is an IT automation tool. It can configure systems, deploy software, and orchestrate more advanced IT tasks such as continuous deployments or zero downtime rolling updates.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("github: "),a("a",{attrs:{href:"https://github.com/ansible/ansible",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/ansible/ansible"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Ansible is a radically simple IT automation system. It handles configuration management, application deployment, cloud provisioning, ad-hoc task execution, network automation, and multi-node orchestration. Ansible makes complex changes like zero-downtime rolling updates with load balancers easy. More information on the Ansible website.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"ansibleの歴史と背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansibleの歴史と背景"}},[s._v("#")]),s._v(" Ansibleの歴史と背景")]),s._v(" "),a("p",[s._v("Ansibleは2012年2月20日にMichael DeHaanによって開発されました。当時、既存の構成管理ツールの複雑さに課題を感じていたDeHaanは、より簡単で効率的なツールを目指してAnsibleを生み出しました。\nAnsibleはその後も順調に改良を重ね、2015年10月にRed Hat社に買収されてからは更にエンタープライズ向けの機能強化が進められています。\n2024年現在、Ansibleの最新バージョンは2.17であり、クラウドネイティブ環境にも対応しています。")]),s._v(" "),a("h3",{attrs:{id:"ansibleの主要コンポーネント"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansibleの主要コンポーネント"}},[s._v("#")]),s._v(" Ansibleの主要コンポーネント")]),s._v(" "),a("p",[s._v("Ansbleには以下の4つの主要なコンポーネントがあります。\nそれぞれはそのまま用語としても使うので覚えておきましょう。")]),s._v(" "),a("ul",[a("li",[s._v("Playbooks: YAML形式で記述される設定ファイル。タスクの順序や条件を定義します。")]),s._v(" "),a("li",[s._v("Modules: 実際にタスクを実行するためのスクリプト。Ansibleには多くの標準モジュールが含まれています。")]),s._v(" "),a("li",[s._v("Inventory: 管理対象のホスト情報を記述するファイル。ホストグループや変数を定義します。")]),s._v(" "),a("li",[s._v("Roles: 再利用可能なPlaybookのセット。特定の機能やサービスの設定をまとめて管理します。")])]),s._v(" "),a("h2",{attrs:{id:"ansible-の特徴"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-の特徴"}},[s._v("#")]),s._v(" Ansible の特徴")]),s._v(" "),a("ul",[a("li",[s._v("エージェントレスである\n"),a("ul",[a("li",[s._v("Ansible は対象の管理は基本的に"),a("a",{attrs:{href:"https://www.openssh.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("OpenSSH"),a("OutboundLink")],1),s._v("を利用する為、専用のクライアント/デーモンを必要としません")])])]),s._v(" "),a("li",[s._v("状態を管理しない\n"),a("ul",[a("li",[s._v("Ansible には対象となるマシン情報（Inventory) を持ちますが、そのマシンの状態を保有することはありません。Inventory ファイルは ansible playbooks などで利用するためのものであり、状態を管理・監視することはありません")])])]),s._v(" "),a("li",[s._v("冪等性を持つ\n"),a("ul",[a("li",[s._v("Ansible は playbooks を基本的に何回実行しても結果は同じになります。例えば httpd のインストールタスク等はインストール済みであれば複数回実行しても 2 回目以降は実行済みとして処理され、二度実行されることがありません。")])])]),s._v(" "),a("li",[s._v("YAML形式の採用\nAnsibleでは、YAMLという人間にも読みやすい形式でPlaybookを記述します。YAMLは直感的で学習が容易であり、複雑な設定も簡潔に表現できます。これにより、チーム内でのコード共有や保守が容易になり、生産性の向上につながります。")])]),s._v(" "),a("h2",{attrs:{id:"ansible-の構成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-の構成"}},[s._v("#")]),s._v(" Ansible の構成")]),s._v(" "),a("p",[s._v("Ansibleは、コントロールノードと管理対象ホストという 2 種類のマシンで構成されています。Ansible はコントロールノードからインストールおよび実行されます。")]),s._v(" "),a("p",[s._v("Ansibleはエージェントレス、ということからAnsibleのインストールはコントロールノードのみに行えばよく、管理対象にインストールする必要はありません。")]),s._v(" "),a("p",[s._v("Ansible のインストールはRPMによる提供もされていますが、現在では"),a("code",[s._v("pip")]),s._v("によるインストールが推奨されています。")]),s._v(" "),a("p",[s._v("Ansibleパッケージは長らく単一のパッケージとなっていましたが、2.10 以降、Ansible のパッケージ方針には大幅な変更がなされ、Ansibleの実行部分と、タスクを実行する（モジュール）の分離がなされ、それぞれ別のパッケージで提供されるようになっています。")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.ansible.com/ansible/latest/modules/list_of_all_modules.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("モジュール一覧"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ansible.com/ansible/latest/plugins/plugins.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("プラグイン一覧"),a("OutboundLink")],1)])]),s._v(" "),a("h3",{attrs:{id:"ansible-の基本用語"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-の基本用語"}},[s._v("#")]),s._v(" Ansible の基本用語")]),s._v(" "),a("p",[s._v("本講義に限らず、Ansible に登場する基本的な用語の解説。\n基本的には以下の引用ですが、一部追加・割愛しています。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.redhat.com/ja/explore/ansible/trailmap/yaml/step3",target:"_blank",rel:"noopener noreferrer"}},[s._v("Ansible Trail Map"),a("OutboundLink")],1)]),s._v(" "),a("h4",{attrs:{id:"target-node-host"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#target-node-host"}},[s._v("#")]),s._v(" Target Node / Host")]),s._v(" "),a("p",[s._v("Ansible から操作する対象で、ホストとも表現されます。Ansible では、Target Node に特別なエージェントなどのインストールは必要ありません。Ansible は、Linux サーバやネットワーク機器、クラウド等の様々なものを操作対象にできます。")]),s._v(" "),a("h4",{attrs:{id:"inventory"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#inventory"}},[s._v("#")]),s._v(" Inventory")]),s._v(" "),a("p",[s._v("操作・管理対象とする Target Node を纏めたリストを指します。Inventory 内において Target Node は複数のグループに分類して登録することができます。この Inventory は、Ansible による処理を実施する場合に必要です。")]),s._v(" "),a("h4",{attrs:{id:"roles"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#roles"}},[s._v("#")]),s._v(" Roles")]),s._v(" "),a("p",[s._v("既知のファイル構造に基づいて特定の変数、タスク、およびハンドラーを自動的に読み込むようひとまとめにしたものです。 ロールでコンテンツをグループ化すると、他のユーザーとのロールの共有が容易になります。")]),s._v(" "),a("h4",{attrs:{id:"task"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#task"}},[s._v("#")]),s._v(" Task")]),s._v(" "),a("p",[s._v("Ansible における、処理（ステップ）の最小単位です。実行対象に対してあってほしい状態や実施する処理を記述します。")]),s._v(" "),a("h4",{attrs:{id:"module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#module"}},[s._v("#")]),s._v(" Module")]),s._v(" "),a("p",[s._v("Ansible において対象に対して何かを実施する際に用いる最小の部品（プログラム）で、Task ごとに一つの Module を指定して利用します。")]),s._v(" "),a("h4",{attrs:{id:"play"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#play"}},[s._v("#")]),s._v(" Play")]),s._v(" "),a("p",[s._v("インベントリ内の対象範囲と実施する 1 つ以上の Task を記載します。")]),s._v(" "),a("h4",{attrs:{id:"playbook"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#playbook"}},[s._v("#")]),s._v(" Playbook")]),s._v(" "),a("p",[s._v("Ansible において、自動化の手順書にあたります。")]),s._v(" "),a("p",[s._v("Playbook の中には、1 つ以上の Play が含まれます。このトレイルマップでは Playbook には 1 つの Play のみの構成となっています。")]),s._v(" "),a("h2",{attrs:{id:"演習-ansible-の導入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#演習-ansible-の導入"}},[s._v("#")]),s._v(" [演習]Ansible の導入")]),s._v(" "),a("p",[s._v("では、実際にAnsibleを使ってみましょう。")]),s._v(" "),a("h3",{attrs:{id:"ansible-のインストール"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ansible-のインストール"}},[s._v("#")]),s._v(" Ansible のインストール")]),s._v(" "),a("p",[s._v("これまで ansible のインストールは "),a("code",[s._v("dnf(yum)")]),s._v(" によるインストールでした。\nしかしながら昨今のansible は pip にてインストールすることが推奨されています。\n従って、今回は"),a("code",[s._v("pip")]),s._v("を用いてインストールしてみましょう。")]),s._v(" "),a("p",[s._v("ただし、演習環境には"),a("code",[s._v("pip")]),s._v("コマンドがインストールされていない為、\nまずは"),a("code",[s._v("pip")]),s._v("のインストールから行う必要があります。\n以下をそれぞれ実行し、ansible のインストールまで行ってください")]),s._v(" "),a("ul",[a("li",[s._v("pip のインストール"),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("dnf "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python3-pip\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[s._v("ansible のインストール"),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ansible\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[s._v("ansible のインストール確認"),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ansible --version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("p",[s._v("ここまで実行したならば以下のような出力が得られるはずです。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v(" ansible --version\nansible "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("core "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.15")]),s._v(".3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  config "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /ansible/ansible.cfg\n  configured module search path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/root/.ansible/plugins/modules'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/usr/share/ansible/plugins/modules'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  ansible python module location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/lib/python3.9/site-packages/ansible\n  ansible collection location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /root/.ansible/collections:/usr/share/ansible/collections\n  executable location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/bin/ansible\n  python version "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.9")]),s._v(".16 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main, May "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2023")]),s._v(", 00:00:00"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("GCC "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11.3")]),s._v(".1 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20221121")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Red Hat "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11.3")]),s._v(".1-4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/bin/python3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  jinja version "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("ansible-core の "),a("code",[s._v("2.5.13")]),s._v("やそれぞれのバージョンには実行する時期によって異なることがありますが問題ありません。")]),s._v(" "),a("credit-footer")],1)}),[],!1,null,null,null);a.default=t.exports}}]);