<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Reactでシングルページアプリケーションを書こう | IIJ Bootcamp</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Reactでシングルページアプリケーションを書こう">
    
    <link rel="preload" href="/bootcamp/assets/css/0.styles.095a7d7e.css" as="style"><link rel="preload" href="/bootcamp/assets/js/app.cf20b39e.js" as="script"><link rel="preload" href="/bootcamp/assets/js/2.09c5bc7f.js" as="script"><link rel="preload" href="/bootcamp/assets/js/9.9b3be782.js" as="script"><link rel="preload" href="/bootcamp/assets/js/17.98516af4.js" as="script"><link rel="preload" href="/bootcamp/assets/js/16.fd8c1616.js" as="script"><link rel="prefetch" href="/bootcamp/assets/js/10.fa1114f6.js"><link rel="prefetch" href="/bootcamp/assets/js/11.b8721122.js"><link rel="prefetch" href="/bootcamp/assets/js/12.a638d493.js"><link rel="prefetch" href="/bootcamp/assets/js/13.dd6eb0fe.js"><link rel="prefetch" href="/bootcamp/assets/js/14.33573406.js"><link rel="prefetch" href="/bootcamp/assets/js/15.b528c6e2.js"><link rel="prefetch" href="/bootcamp/assets/js/18.aad2b757.js"><link rel="prefetch" href="/bootcamp/assets/js/19.86a73a9d.js"><link rel="prefetch" href="/bootcamp/assets/js/20.9ea6b8a5.js"><link rel="prefetch" href="/bootcamp/assets/js/21.4a89ec7d.js"><link rel="prefetch" href="/bootcamp/assets/js/22.e50dd80f.js"><link rel="prefetch" href="/bootcamp/assets/js/23.46816d96.js"><link rel="prefetch" href="/bootcamp/assets/js/24.51864572.js"><link rel="prefetch" href="/bootcamp/assets/js/25.59e28d48.js"><link rel="prefetch" href="/bootcamp/assets/js/26.addb59f2.js"><link rel="prefetch" href="/bootcamp/assets/js/27.19f7d62b.js"><link rel="prefetch" href="/bootcamp/assets/js/28.67fdfc00.js"><link rel="prefetch" href="/bootcamp/assets/js/29.cee133e1.js"><link rel="prefetch" href="/bootcamp/assets/js/3.db34a59f.js"><link rel="prefetch" href="/bootcamp/assets/js/30.96e2343a.js"><link rel="prefetch" href="/bootcamp/assets/js/31.933bab7f.js"><link rel="prefetch" href="/bootcamp/assets/js/32.5dd7bbd1.js"><link rel="prefetch" href="/bootcamp/assets/js/33.4440109e.js"><link rel="prefetch" href="/bootcamp/assets/js/34.ce1abe0e.js"><link rel="prefetch" href="/bootcamp/assets/js/35.9b5e4c45.js"><link rel="prefetch" href="/bootcamp/assets/js/36.53033b52.js"><link rel="prefetch" href="/bootcamp/assets/js/37.3f9bf71e.js"><link rel="prefetch" href="/bootcamp/assets/js/38.0654fab9.js"><link rel="prefetch" href="/bootcamp/assets/js/39.fd14a75e.js"><link rel="prefetch" href="/bootcamp/assets/js/4.20506e07.js"><link rel="prefetch" href="/bootcamp/assets/js/40.8e845cbf.js"><link rel="prefetch" href="/bootcamp/assets/js/41.f46d6efe.js"><link rel="prefetch" href="/bootcamp/assets/js/42.0538b953.js"><link rel="prefetch" href="/bootcamp/assets/js/43.76d3f89f.js"><link rel="prefetch" href="/bootcamp/assets/js/44.4707d870.js"><link rel="prefetch" href="/bootcamp/assets/js/45.6d5d6837.js"><link rel="prefetch" href="/bootcamp/assets/js/46.fb3c28ff.js"><link rel="prefetch" href="/bootcamp/assets/js/47.7786442e.js"><link rel="prefetch" href="/bootcamp/assets/js/48.a479bfd6.js"><link rel="prefetch" href="/bootcamp/assets/js/49.4a2e7bee.js"><link rel="prefetch" href="/bootcamp/assets/js/5.fcef7a00.js"><link rel="prefetch" href="/bootcamp/assets/js/50.1b4953d3.js"><link rel="prefetch" href="/bootcamp/assets/js/51.c75eeeb0.js"><link rel="prefetch" href="/bootcamp/assets/js/52.df3c3eec.js"><link rel="prefetch" href="/bootcamp/assets/js/53.ca33ed0f.js"><link rel="prefetch" href="/bootcamp/assets/js/54.f512b053.js"><link rel="prefetch" href="/bootcamp/assets/js/55.38140b71.js"><link rel="prefetch" href="/bootcamp/assets/js/56.411fe454.js"><link rel="prefetch" href="/bootcamp/assets/js/57.cbafb146.js"><link rel="prefetch" href="/bootcamp/assets/js/58.08923178.js"><link rel="prefetch" href="/bootcamp/assets/js/59.47e75bb6.js"><link rel="prefetch" href="/bootcamp/assets/js/6.c68391aa.js"><link rel="prefetch" href="/bootcamp/assets/js/60.edf1058a.js"><link rel="prefetch" href="/bootcamp/assets/js/61.f72b1b8b.js"><link rel="prefetch" href="/bootcamp/assets/js/62.ce5311e9.js"><link rel="prefetch" href="/bootcamp/assets/js/63.c9bf3c7a.js"><link rel="prefetch" href="/bootcamp/assets/js/7.1b1497a0.js"><link rel="prefetch" href="/bootcamp/assets/js/8.8b4fbdd6.js">
    <link rel="stylesheet" href="/bootcamp/assets/css/0.styles.095a7d7e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bootcamp/" class="home-link router-link-active"><!----> <span class="site-name">IIJ Bootcamp</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/iij/bootcamp" target="_blank" rel="noopener noreferrer" class="repo-link">
      GitHub
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/iij/bootcamp" target="_blank" rel="noopener noreferrer" class="repo-link">
      GitHub
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Reactでシングルページアプリケーションを書こう</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bootcamp/frontend/react/#講義の全体像" class="sidebar-link">講義の全体像</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bootcamp/frontend/react/#実行環境の用意" class="sidebar-link">実行環境の用意</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#_1-codesandboxを利用する" class="sidebar-link">1. CodeSandboxを利用する</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#_2-viteを利用してローカル環境にプロジェクトの雛形を用意する" class="sidebar-link">2. Viteを利用してローカル環境にプロジェクトの雛形を用意する</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#フォルダ構成" class="sidebar-link">フォルダ構成</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#スタイルシートの適用" class="sidebar-link">スタイルシートの適用</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#🚩チェックポイント" class="sidebar-link">🚩チェックポイント</a></li></ul></li><li><a href="/bootcamp/frontend/react/#要素技術の軽い紹介" class="sidebar-link">要素技術の軽い紹介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#reactが解決してくれる課題" class="sidebar-link">Reactが解決してくれる課題</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#react" class="sidebar-link">React</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#typescript" class="sidebar-link">TypeScript</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#jsx-tsx" class="sidebar-link">JSX(TSX)</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#🚩チェックポイント-2" class="sidebar-link">🚩チェックポイント</a></li></ul></li><li><a href="/bootcamp/frontend/react/#reactコンポーネントとプロパティ" class="sidebar-link">Reactコンポーネントとプロパティ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#とりあえずreactを動作させる" class="sidebar-link">とりあえずReactを動作させる</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#コンポーネントを切り分けてみる" class="sidebar-link">コンポーネントを切り分けてみる</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#プロパティで親コンポーネントから値を渡す" class="sidebar-link">プロパティで親コンポーネントから値を渡す</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#繰り返し処理" class="sidebar-link">繰り返し処理</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#条件分岐で描画内容を変更する" class="sidebar-link">条件分岐で描画内容を変更する</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#🚩チェックポイント-3" class="sidebar-link">🚩チェックポイント</a></li></ul></li><li><a href="/bootcamp/frontend/react/#stateとその変更に対するリアクティブな動作" class="sidebar-link">Stateとその変更に対するリアクティブな動作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#カウンタプログラム" class="sidebar-link">カウンタプログラム</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#文字列のstateとonchange" class="sidebar-link">文字列のStateとonChange</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#フィルタ処理で見るもっとリアクティブな例" class="sidebar-link">フィルタ処理で見るもっとリアクティブな例</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#🚩チェックポイント-4" class="sidebar-link">🚩チェックポイント</a></li></ul></li><li><a href="/bootcamp/frontend/react/#todoアプリ" class="sidebar-link">ToDoアプリ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#フィルタ付きリストからtodoアプリの基礎を作る" class="sidebar-link">フィルタ付きリストからToDoアプリの基礎を作る</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#状態確認用コンポーネントを追加する" class="sidebar-link">状態確認用コンポーネントを追加する</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#データの更新処理-update-に対応する" class="sidebar-link">データの更新処理(Update)に対応する</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#終了したtodoを非表示にするフィルタ条件を追加する" class="sidebar-link">終了したToDoを非表示にするフィルタ条件を追加する</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#データの追加処理-create-に対応する" class="sidebar-link">データの追加処理(Create)に対応する</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#状態とそれに対する操作をカスタムhookとしてまとめる" class="sidebar-link">状態とそれに対する操作をカスタムHookとしてまとめる</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#データの削除処理-delete-に対応する" class="sidebar-link">データの削除処理(Delete)に対応する</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#🚩チェックポイント-5" class="sidebar-link">🚩チェックポイント</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#発展課題" class="sidebar-link">発展課題</a></li></ul></li><li><a href="/bootcamp/frontend/react/#apiサーバとのやりとりを行うtodoアプリ" class="sidebar-link">APIサーバとのやりとりを行うToDoアプリ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#サーバを立ててアクセスしてみる-vite環境のみ" class="sidebar-link">サーバを立ててアクセスしてみる(Vite環境のみ)</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#発展課題-2" class="sidebar-link">発展課題</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#アプリをビルドしてコンテナ化する-vite環境のみ" class="sidebar-link">アプリをビルドしてコンテナ化する(Vite環境のみ)</a></li></ul></li><li><a href="/bootcamp/frontend/react/#参考になるサイト" class="sidebar-link">参考になるサイト</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#react-2" class="sidebar-link">React</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#javascript" class="sidebar-link">JavaScript</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#typescript-2" class="sidebar-link">TypeScript</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><table><tr><td>このハンズオンでやること</td><td>Reactでシングルページアプリケーションを書こう</td></tr> <tr><td>想定時間</td><td>2h</td></tr> <tr><td>前提知識・用語</td><td>ブラウザのDOM操作</td></tr></table> <h1 id="page-frontmatter-title"><a href="#page-frontmatter-title" class="header-anchor">#</a> Reactでシングルページアプリケーションを書こう</h1> <p></p><div class="table-of-contents"><ul><li><a href="#講義の全体像">講義の全体像</a></li><li><a href="#実行環境の用意">実行環境の用意</a><ul><li><a href="#_1-codesandboxを利用する">1. CodeSandboxを利用する</a></li><li><a href="#_2-viteを利用してローカル環境にプロジェクトの雛形を用意する">2. Viteを利用してローカル環境にプロジェクトの雛形を用意する</a></li><li><a href="#フォルダ構成">フォルダ構成</a></li><li><a href="#スタイルシートの適用">スタイルシートの適用</a></li><li><a href="#🚩チェックポイント">🚩チェックポイント</a></li></ul></li><li><a href="#要素技術の軽い紹介">要素技術の軽い紹介</a><ul><li><a href="#reactが解決してくれる課題">Reactが解決してくれる課題</a></li><li><a href="#react">React</a></li><li><a href="#typescript">TypeScript</a></li><li><a href="#jsx-tsx">JSX(TSX)</a></li><li><a href="#🚩チェックポイント">🚩チェックポイント</a></li></ul></li><li><a href="#reactコンポーネントとプロパティ">Reactコンポーネントとプロパティ</a><ul><li><a href="#とりあえずreactを動作させる">とりあえずReactを動作させる</a></li><li><a href="#コンポーネントを切り分けてみる">コンポーネントを切り分けてみる</a></li><li><a href="#プロパティで親コンポーネントから値を渡す">プロパティで親コンポーネントから値を渡す</a></li><li><a href="#繰り返し処理">繰り返し処理</a></li><li><a href="#条件分岐で描画内容を変更する">条件分岐で描画内容を変更する</a></li><li><a href="#🚩チェックポイント">🚩チェックポイント</a></li></ul></li><li><a href="#stateとその変更に対するリアクティブな動作">Stateとその変更に対するリアクティブな動作</a><ul><li><a href="#カウンタプログラム">カウンタプログラム</a></li><li><a href="#文字列のstateとonchange">文字列のStateとonChange</a></li><li><a href="#フィルタ処理で見るもっとリアクティブな例">フィルタ処理で見るもっとリアクティブな例</a></li><li><a href="#🚩チェックポイント">🚩チェックポイント</a></li></ul></li><li><a href="#todoアプリ">ToDoアプリ</a><ul><li><a href="#フィルタ付きリストからtodoアプリの基礎を作る">フィルタ付きリストからToDoアプリの基礎を作る</a></li><li><a href="#状態確認用コンポーネントを追加する">状態確認用コンポーネントを追加する</a></li><li><a href="#データの更新処理-update-に対応する">データの更新処理(Update)に対応する</a></li><li><a href="#終了したtodoを非表示にするフィルタ条件を追加する">終了したToDoを非表示にするフィルタ条件を追加する</a></li><li><a href="#データの追加処理-create-に対応する">データの追加処理(Create)に対応する</a></li><li><a href="#状態とそれに対する操作をカスタムhookとしてまとめる">状態とそれに対する操作をカスタムHookとしてまとめる</a></li><li><a href="#データの削除処理-delete-に対応する">データの削除処理(Delete)に対応する</a></li><li><a href="#🚩チェックポイント">🚩チェックポイント</a></li><li><a href="#発展課題">発展課題</a></li></ul></li><li><a href="#apiサーバとのやりとりを行うtodoアプリ">APIサーバとのやりとりを行うToDoアプリ</a><ul><li><a href="#サーバを立ててアクセスしてみる-vite環境のみ">サーバを立ててアクセスしてみる(Vite環境のみ)</a></li><li><a href="#発展課題">発展課題</a></li><li><a href="#アプリをビルドしてコンテナ化する-vite環境のみ">アプリをビルドしてコンテナ化する(Vite環境のみ)</a></li></ul></li><li><a href="#参考になるサイト">参考になるサイト</a><ul><li><a href="#react">React</a></li><li><a href="#javascript">JavaScript</a></li><li><a href="#typescript">TypeScript</a></li></ul></li></ul></div><p></p> <h2 id="講義の全体像"><a href="#講義の全体像" class="header-anchor">#</a> 講義の全体像</h2> <p>この講義では <strong>「ToDoアプリを作ってReactによる実践的な実装パターンを体感しよう」</strong> を目標として、以下の構成で進めていきます。</p> <ul><li>Reactの基本的な動作を体感する(プロパティ、State、イベントハンドラ)
<ul><li>⛳️プログラミング初心者の人のゴール</li></ul></li> <li>ToDoアプリでより実践的な実装パターンを体感する
<ul><li>⛳️通常のゴール</li></ul></li> <li>ToDoアプリでサーバとやり取りする
<ul><li>⛳️進みが早い人のゴール</li></ul></li></ul> <p>人によっては既に知っている内容も含まれると思いますので、適宜先へ先へと進めていってください。</p> <p>通常のゴールまで辿り着けば、以下のようなアプリが完成する予定です。</p> <p><img src="/bootcamp/assets/img/todo.6f048801.gif" alt=""></p> <p>頑張っていきましょう😉</p> <h2 id="実行環境の用意"><a href="#実行環境の用意" class="header-anchor">#</a> 実行環境の用意</h2> <p>この講義では実行環境として以下の2つを想定します。
環境構築に慣れていない人には1のCodeSandboxを、実際の開発環境に近いことをしたい人には2のViteをお勧めします。</p> <h3 id="_1-codesandboxを利用する"><a href="#_1-codesandboxを利用する" class="header-anchor">#</a> 1. CodeSandboxを利用する</h3> <p><a href="https://codesandbox.io/" target="_blank" rel="noopener noreferrer">CodeSandbox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を利用してReactの環境を用意します。</p> <p>React TypeScriptの環境である<a href="https://codesandbox.io/s/react-typescript-react-ts" target="_blank" rel="noopener noreferrer">https://codesandbox.io/s/react-typescript-react-ts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を開いてください。
以下のようなページが表示されると思います。</p> <p><img src="/bootcamp/assets/img/setup-codesandbox.dc9e161f.png" alt=""></p> <p>以上で環境のセットアップはほぼ完了です。簡単ですね😉</p> <p>この環境ではエディタとブラウザが左右に表示されており、ファイルをセーブすると自動でブラウザの内容が更新されます。</p> <p>残るちょっとした作業として、<code>src/index.tsx</code>の以下の場所に<code>import &quot;./styles.css&quot;</code>の行を追加しておいてください。</p> <div class="language-tsx line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br></div><pre class="language-tsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&quot;react-dom/client&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&quot;./App&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;./styles.css&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>これから<code>App.tsx</code>は頻繁に書き換えるため、代わりに特に触ることのない<code>index.tsx</code>からスタイルシートを<code>import</code>するようにします。</p> <h3 id="_2-viteを利用してローカル環境にプロジェクトの雛形を用意する"><a href="#_2-viteを利用してローカル環境にプロジェクトの雛形を用意する" class="header-anchor">#</a> 2. Viteを利用してローカル環境にプロジェクトの雛形を用意する</h3> <p><a href="https://vitejs.dev" target="_blank" rel="noopener noreferrer">Vite<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を利用してローカル環境にプロジェクトの雛形を用意します。</p> <p>Viteを利用した環境のセットアップを例示しておきます。
難しそうであればCodeSandboxを利用してください。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># NodeJSのインストール(インストール済みの場合はスキップ)</span>
<span class="token comment"># nodeコマンドとnpmコマンドが使えるようになれば方法は任意です</span>
<span class="token comment"># 以下はasdfを利用した一例です</span>
asdf plugin <span class="token function">add</span> nodejs
asdf <span class="token function">install</span> nodejs latest
asdf global nodejs latest

<span class="token comment"># Viteを利用したプロジェクトのセットアップ</span>
<span class="token function">npm</span> create vite@latest bootcamp-react
<span class="token comment"># =&gt; React =&gt; TypeScript を選択する</span>
<span class="token builtin class-name">cd</span> bootcamp-react
<span class="token function">npm</span> <span class="token function">install</span>
<span class="token function">npm</span> run dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>開発サーバが起動し、ブラウザで<a href="http://localhost:5173" target="_blank" rel="noopener noreferrer">http://localhost:5173<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>にアクセスして以下のような画面が見れれば成功です😉</p> <p><img src="/bootcamp/assets/img/setup-vite.ad9d3882.png" alt=""></p> <p>この環境ではファイルを更新すると自動でブラウザの表示も更新されます。
開発のためのエディタは好きなものを利用してください。</p> <h3 id="フォルダ構成"><a href="#フォルダ構成" class="header-anchor">#</a> フォルダ構成</h3> <p>Reactのプロジェクトのフォルダにはいろんなファイルがありますが、この講義では<code>src</code>フォルダだけを気にしてもらえれば大丈夫です。<code>src</code>フォルダの中にもいろんなファイルがありますが、ひとまず以下に示す3つのファイルのみを気にしてください。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(プロジェクトのフォルダ)
├── src
│   ├── App.tsx     ← メインのアプリ実装
│   ├── index.tsx   ← アプリのセットアップ (Viteの場合はmain.tsx)
│   ├── styles.css  ← スタイルシート      (Viteの場合はindex.css)
│   └── (その他諸々)
└── (その他諸々)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>この講義では主に<code>src/App.tsx</code>を編集してReactの動作を確認していきます。</p> <div class="custom-block warning"><p class="custom-block-title">以降はCodeSandboxのファイル構成で説明します</p> <p>Vite環境の方は適宜読み替えをお願いします。</p></div> <h3 id="スタイルシートの適用"><a href="#スタイルシートの適用" class="header-anchor">#</a> スタイルシートの適用</h3> <p>今回のハンズオン用のスタイルシートをあらかじめ<a href="https://github.com/asa-taka/bootcamp-todo/blob/main/src/index.css" target="_blank" rel="noopener noreferrer">github.com/asa-taka/bootcamp-todo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>に用意しておきました。
それぞれの環境ごとに以下のファイルにコピペで上書きしてください。</p> <ul><li>CodeSandbox環境: <code>src/styles.css</code></li> <li>Vite環境: <code>src/index.css</code></li></ul> <h3 id="🚩チェックポイント"><a href="#🚩チェックポイント" class="header-anchor">#</a> 🚩チェックポイント</h3> <p>ここまでで以下の準備が終わっていれば完璧です😉</p> <ul><li>CodeSandbox、もしくはViteを利用してReactの開発環境の準備ができた
<ul><li>コードを編集する準備と、ブラウザの表示を確認する準備ができた</li></ul></li> <li>Reactのプロジェクトの<code>src</code>フォルダが確認できた</li> <li>ハンズオン用のスタイルシートの適用が終わった</li></ul> <h2 id="要素技術の軽い紹介"><a href="#要素技術の軽い紹介" class="header-anchor">#</a> 要素技術の軽い紹介</h2> <p>手を動かす前に軽くReactと、Reactと共に使われる要素技術の紹介をしておきます。
まだセットアップが間に合っていない人はTAを呼ぶなりして、この時間に頑張って間に合わせてください😉</p> <h3 id="reactが解決してくれる課題"><a href="#reactが解決してくれる課題" class="header-anchor">#</a> Reactが解決してくれる課題</h3> <p>先に行われたDOMの講義を通して、ブラウザの標準APIとして存在するDOM操作のメソッドを利用し、表示中の画面を書き換えられることは体感できたと思います。</p> <p>しかしDOM操作を直接行う方法では、次のような複雑なDOMに対して変更を行おうとした場合には大変になります。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>profile-list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>profile-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>profile-pict<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>profile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>profile-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- ...繰り返し... --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>昨今のHTMLはネストが深く属性も山盛りです。
そして実際のウェブアプリはこの数十倍の複雑さになります。
さらにアプリの種類によっては頻繁で細やかな表示の変更が求められることもあります。</p> <p>この膨大なDOMに対して、変更内容に応じた更新をかける処理をブラウザの素朴なAPIを利用して開発するのは現実的ではありません。</p> <p>Reactを利用することでこのような処理が簡単に描けるようになります。</p> <h3 id="react"><a href="#react" class="header-anchor">#</a> React</h3> <p><a href="https://react.dev" target="_blank" rel="noopener noreferrer">React<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>はMeta(旧Facebook)発のUIフレームワークです。</p> <p>ReactとはデータとDOMの対応付けをやってくれるフレームワークであり、さらにデータの更新に対してリアクティブ(反応的)に画面を更新してくれるフレームワークです。
この「リアクティブな画面更新」を行う機能により複雑で画面が繊細に更新されるようなウェブアプリを効率的に開発することができます。
その辺りはSvelteと同様の位置付けのフレームワークです。</p> <p>…と、こんなことを言われてもピンとこないですよね。それを理解するためのハンズオンです😉</p> <h3 id="typescript"><a href="#typescript" class="header-anchor">#</a> TypeScript</h3> <p>Reactの開発ではJavaScriptの代わりに、その拡張言語である<a href="https://www.typescriptlang.org" target="_blank" rel="noopener noreferrer">TypeScript<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>をよく使います。
TypeScriptはMicrosoft発の、JavaScriptに<strong>型</strong>の概念を加えた言語です。</p> <p>例えば以下の関数定義は</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> n <span class="token operator">*</span> <span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TypeScriptでは次のように書けます。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> n <span class="token operator">*</span> <span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>引数に<code>number</code>という型をつけることができます。
これにより「この関数の引数はどのような値であるべきか」という、JavaScriptではコメントで表現するしかなかった部分を補完することができます。
逆に型以外の点ではJavaScriptとほぼ同じ表記になります。</p> <p>もう少し複雑なオブジェクトを定義して用いることもできます。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Props</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token operator">:</span> Props<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> props<span class="token punctuation">.</span>value <span class="token operator">*</span> <span class="token number">2</span>

<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// =&gt; エラーなし</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>ここでは<code>Props</code>という型を定義して関数の引数に利用しています。
Reactでは主にプロパティやStateの型、それからそのアプリが扱うデータの型を定義するのに便利になります。</p> <div class="custom-block tip"><p class="custom-block-title">TypeScriptを試してみる</p> <p>TypeScriptでどのような表現が可能かは<a href="https://www.typescriptlang.org/play" target="_blank" rel="noopener noreferrer">TS Playground<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>で実際に試すと理解しやすいでしょう。</p> <p>また<a href="https://deno.com" target="_blank" rel="noopener noreferrer">Deno<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>というNodeJSとは別のJavaScript実行環境ではデフォルトでTypeScriptを実行できます。</p></div> <div class="custom-block tip"><p class="custom-block-title">TypeScriptの実行環境</p> <p>TypeScriptは通常、そのままではブラウザやNodeJSなどのJavaScriptの実行環境では実行できず、以下の流れで処理する必要があります。</p> <ol><li>TypeScriptでソースコードを記述</li> <li>コンパイラ(トランスパイラ)が型チェックをしながらソースコードをJavaScriptに変換</li> <li>ブラウザ等JavaScriptの動作環境で実行</li></ol> <p>実際にはこの流れはツール類がほぼ自動で実行してくれます。
包括的なツールとして最近では<a href="https://vitejs.dev" target="_blank" rel="noopener noreferrer">Vite<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>がよく使われます。</p> <p>面倒に見えるかもしれませんが、最近ではツール類が洗練され、設定の手間がほとんどかからなくなっています。
一般にReactで開発を行う際もTypeScriptがよく使われるため、この講義でもTypeScriptの利用を前提として進めます。</p></div> <h3 id="jsx-tsx"><a href="#jsx-tsx" class="header-anchor">#</a> JSX(TSX)</h3> <p>さらにReactでは<strong>JSX</strong>というJavaScriptの拡張言語を使います。
JSXは簡単に言えば「JavaScriptのコード中にHTMLを書けるようにした言語」です。</p> <p>例えば以下のような表現ができます。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> <span class="token function">Hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> myName <span class="token operator">=</span> <span class="token string">'asa-taka'</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Hello </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>myName<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>どうでしょうか。気持ち悪いですね😉</p> <p>JavaScriptとHTMLが入り混じっています。
ここでは2つだけJSXのルールを紹介しておきますが、まだ覚える必要はありません。</p> <div class="custom-block warning"><p class="custom-block-title">JSXのルール</p> <ul><li><strong>JSX要素は<code>return</code>や変数への代入など、JavaScriptの「値(より正確には式)」として、任意の場所で使える</strong> <ul><li>ただしルートの要素は1つでなければならない</li></ul></li> <li><strong>JSXの中(要素の属性値or子要素)では<code>{}</code>で囲むことでJavaScriptの表現が使える</strong> <ul><li>ただし値を返すもの(簡単に言えばそのまま変数に代入できるもの)に限ります</li> <li>例として<code>{1}</code>や<code>{fn(1, 'foo') + 1}</code>は正しいJSX中の表現ですが<code>{if ...}</code>は使えません
<ul><li>条件分岐には<code>&amp;&amp;</code>や<code>?:</code>が、繰り返しには配列の<code>map</code>メソッドなどがよく使われます</li></ul></li></ul></li></ul></div> <p>ハンズオンを進めながら、理解を深めたくなったらまた戻ってきてください。</p> <p>ウェブアプリを開発する上では慣れるとJSXの方が便利なのと、他のReactの解説でもほぼJSXが使われているため、この講義でもJSXの利用を前提として進めます。</p> <p>TypeScriptとJSXを合わせたものは特にTSXと呼ばれることもありますが、その場合でもJSXと呼ばれることが多いです。
ただし拡張子は<code>.jsx</code>ではなく<code>.tsx</code>がよく使われます。</p> <div class="custom-block warning"><p class="custom-block-title">HTMLとは属性名が異なる場合がある</p> <p><code>class</code>が<code>className</code>になっているなど、JavaScriptの予約語の都合上、属性名が通常のHTMLとは異なるものがあるので気をつけてください。
他にも<code>for</code>が<code>htmlFor</code>になっていたりします。</p> <p>ただしこれらはJSX独自の仕様というよりは<a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/className" target="_blank" rel="noopener noreferrer">Web API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>の仕様から来るものに思われます。</p></div> <div class="custom-block tip"><p class="custom-block-title">JSXにも変換処理が必要</p> <p>TypeScriptと同様、JSXも純粋なJavaScriptではないため、ブラウザ上で動作させるためにはJavaScriptに変換する処理が必要になります。
ただしこの変換も、今回セットアップしたようなツールにより自動化されています。</p></div> <div class="custom-block tip"><p class="custom-block-title">JSXは実際には何を表しているのか</p> <p>JSXが最終的なJavaScriptでどのような値になるかはコンパイラの設定によります。
Reactの場合は<code>ReactElement</code>という特定の型のオブジェクトを返し、詳細は省きますがこれはReactによるVirtual DOMのノードの表現です。</p> <p>コンパイラの変換処理としては</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>というJSXのコードは</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> element <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> className<span class="token operator">:</span> <span class="token string">'app'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>という純粋なJavaScriptのコードと等価です。
<code>ReactElement</code>が具体的にどのようなオブジェクトなのか、気になる人は適当に<code>console.log(&lt;div /&gt;)</code>を含めたコードの出力をブラウザのコンソールで覗いてみてください。</p> <p>このようにシンプルな変換処理(シンタックスシュガー)があるだけで実体としては純粋なJavaScriptと同じと思ってもらえると、初見での気持ち悪さはだいぶ軽減されると思います。</p></div> <h3 id="🚩チェックポイント-2"><a href="#🚩チェックポイント-2" class="header-anchor">#</a> 🚩チェックポイント</h3> <p>この章では以下のことを説明しましたが、まだそこまで理解できていなくても大丈夫です😉</p> <ul><li><strong>React</strong>はデータの変更に対しリアクティブに画面を更新することで細やかな画面更新が必要なアプリを開発できるフレームワークである</li> <li>Reactの開発では<strong>TypeScript</strong>という、JavaScriptに型を追加した拡張言語を使うと便利である</li> <li>Reactの開発では<strong>JSX</strong>という、JavaScriptの中にHTMLを書けるような拡張言語を使うのが主流である</li></ul> <h2 id="reactコンポーネントとプロパティ"><a href="#reactコンポーネントとプロパティ" class="header-anchor">#</a> Reactコンポーネントとプロパティ</h2> <p>前置きが長くなりましたがReactを触っていきましょう😉</p> <p>Reactでは画面を構成する部品を「コンポーネント」という単位で定義します。
ここでは最もシンプルなReactコンポーネントとして、プロパティを受け取り描画内容を返すだけのReactコンポーネントを作っていきましょう。</p> <h3 id="とりあえずreactを動作させる"><a href="#とりあえずreactを動作させる" class="header-anchor">#</a> とりあえずReactを動作させる</h3> <p>この講義では主に<code>src/App.tsx</code>を編集してReactの動作を確認していきます。
手始めに<code>App.tsx</code>を<strong>丸ごと</strong>以下のように書き換えてください。既にあるコードはすべて消してしまって大丈夫です。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        Hello, </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">React!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>成功すると以下のような表示になります😉</p> <p><img src="/bootcamp/assets/img/ex-props1.322f9550.png" alt=""></p> <p>おめでとうございます。ここでは<code>App</code>というコンポーネントを定義しました。
Reactではコンポーネントを「DOMのようなもの」を返す関数として定義します。
この場合<code>App</code>は<code>div</code>要素に囲まれた「Hello, React!」と表示される「DOMのようなもの」を表しています。
「DOMのようなもの」だと言いにくいので以降は「JSX要素」と呼ぶことにします。</p> <p>そして<code>App</code>というコンポーネントは<code>src/index.tsx</code>で読み込まれDOMとしてレンダリング(DOMを操作して描画)されます。</p> <h3 id="コンポーネントを切り分けてみる"><a href="#コンポーネントを切り分けてみる" class="header-anchor">#</a> コンポーネントを切り分けてみる</h3> <p>先ほど「コンポーネント」とは「画面を構成する部品」と説明しました。
この考え方を理解するために、<code>App</code>コンポーネントの描画内容の一部を切り分けてみましょう。</p> <p>以下のように<code>App.tsx</code>を書き換えてください。</p> <div class="language-tsx line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">function</span> <span class="token function">Hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      Hello, </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">React!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Hello</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>この変更では表示内容は特に変わりません。</p> <p>新しく<code>Hello</code>というコンポーネントを定義し、<code>App</code>の中にあった「Hello, React!」の<code>p</code>要素を切り分けました。
そして新しい表現として、その<code>Hello</code>コンポーネントを<code>App</code>の中で<code>&lt;Hello /&gt;</code>として利用しています。
このように他のコンポーネントもJSXの表記により利用することができます。</p> <p>この<code>App</code>の中で<code>Hello</code>が使われる、という関係を指してそれぞれを <strong>親コンポーネント</strong> (ここでは<code>App</code>)、<strong>子コンポーネント</strong> (ここでは<code>Hello</code>)と呼びます。</p> <h3 id="プロパティで親コンポーネントから値を渡す"><a href="#プロパティで親コンポーネントから値を渡す" class="header-anchor">#</a> プロパティで親コンポーネントから値を渡す</h3> <p>コンポーネントには引数としてオブジェクトを渡すことができます。
これをReactでは「プロパティ」と呼んでいます。
プロパティを利用することでコンポーネントの動作や表示内容にバリエーションを持たせることができます。</p> <p><code>Hello</code>コンポーネントに<code>yourName</code>プロパティを追加して、挨拶する相手を指定できるようにしてみましょう。</p> <p>以下のように<code>App.tsx</code>を書き換えてください。</p> <div class="language-tsx line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">type</span> <span class="token class-name">HelloProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  yourName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Hello</span><span class="token punctuation">(</span><span class="token punctuation">{</span> yourName <span class="token punctuation">}</span><span class="token operator">:</span> HelloProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      Hello, </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>yourName<span class="token punctuation">}</span><span class="token plain-text">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Hello</span></span> <span class="token attr-name">yourName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>asa-taka<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>成功すると以下のような表示になります😉</p> <p><img src="/bootcamp/assets/img/ex-props3.053f2189.png" alt=""></p> <p><code>type HelloProps</code>というのはTypeScriptの表現であり、ここでは<code>Hello</code>コンポーネントがプロパティとして何を受け付けるかを表すための型を定義しています。
そして受け取った<code>yourName</code>プロパティを<code>{yourName}</code>としてJSXの中で参照しています。
Reactではこのように汎用性を持たせながら、機能や描画内容の切り出しを行います。</p> <p>さて、これができたら続けて<code>Hello</code>コンポーネントの<code>yourName</code>プロパティを変更して複数回使用してみましょう。</p> <p>以下のように<code>App.tsx</code>を書き換えてください。</p> <div class="language-tsx line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">type</span> <span class="token class-name">HelloProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  yourName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Hello</span><span class="token punctuation">(</span><span class="token punctuation">{</span> yourName <span class="token punctuation">}</span><span class="token operator">:</span> HelloProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      Hello, </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>yourName<span class="token punctuation">}</span><span class="token plain-text">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Hello</span></span> <span class="token attr-name">yourName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>asa-taka<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Hello</span></span> <span class="token attr-name">yourName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>igarashi<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Hello</span></span> <span class="token attr-name">yourName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ueda<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>成功すると以下のような表示になります😉</p> <p><img src="/bootcamp/assets/img/ex-props4.d77900e5.png" alt=""></p> <p>コンポーネントの切り分けと一部の要素をプロパティとして抜き出すことで整理されたコードが書けることがわかると思います。
コンポーネントらしくなってきましたね。</p> <h3 id="繰り返し処理"><a href="#繰り返し処理" class="header-anchor">#</a> 繰り返し処理</h3> <p>JSXの中では<code>{}</code>で囲むことでJavaScriptの表現がそのまま使えるので、これを利用して更に処理をプログラム的にしてみましょう。
繰り返し処理を利用して同じような要素の生成をまとめて行います。</p> <p>繰り返し処理といえば<code>for</code>文ですが、これはJSXの中では直接は使うことができないため、配列の<a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/map" target="_blank" rel="noopener noreferrer"><code>map</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>メソッドがよく利用されます。</p> <p>配列の<code>map</code>メソッドは、例えば以下のように使われるメソッドです。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> doubled <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>doubled<span class="token punctuation">)</span>
<span class="token comment">// =&gt; [2, 4, 6, 8]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>というように、配列の全ての要素に対して引数で渡された関数による変換を行った新たな配列を生成します。
この場合は<code>(x) =&gt; x * 2</code>という「引数を倍にして返す関数」を渡すことで、各要素を倍にした配列を得ることができます。</p> <p>Reactではこれを、配列からJSXの要素を生成するためによく使います。
つまり、配列の個々の要素を受け取りJSXを返す関数を書くことでJSXの要素の配列を生成することができます。</p> <div class="custom-block tip"><p class="custom-block-title">アロー関数</p> <p>アロー関数は<code>(引数1, 引数2, ...) =&gt; { ... }</code>の形で定義される関数です。
<code>{}</code>内の式(expression)が一つの場合は<code>{}</code>を省略でき、その場合はその式の値がそのまま返り値になります。</p> <p><code>function</code>による関数定義とは何点か違いがありますが、この講義では以下のように使い分けています。</p> <ul><li>コンポーネント定義では<code>function</code>を利用する
<ul><li><code>function</code> による定義を行うとその関数に <code>.name</code> というプロパティで名前がつくため</li> <li>この名前により開発用の拡張機能やコンポーネントのエラーメッセージが読みやすくなる</li></ul></li> <li>それ以外の用途では<code>=&gt;</code>を利用する
<ul><li>シンプルで読みやすいため</li></ul></li></ul> <p>この辺りはプロジェクトごとに方針があるので、それに従うのが良いでしょう。</p></div> <p>さて、前置きが長くなりましたが以下のように<code>App.tsx</code>を書き換えてください。</p> <div class="language-tsx line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">type</span> <span class="token class-name">HelloProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  yourName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Hello</span><span class="token punctuation">(</span><span class="token punctuation">{</span> yourName <span class="token punctuation">}</span><span class="token operator">:</span> HelloProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      Hello, </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>yourName<span class="token punctuation">}</span><span class="token plain-text">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> members <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;asa-taka&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;igarashi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ueda&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>members<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Hello</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>member<span class="token punctuation">}</span></span> <span class="token attr-name">yourName</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>member<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>この変更では表示内容は特に変わりません。</p> <p>配列の要素には<code>key</code>という特殊なプロパティが新たに必要になる点に注意してください。
ここでは配列の中で一意な値を設定する必要があるとだけ覚えておけば十分です。
今回は<code>member</code>の値ががそもそも全て異なっているので、それをそのまま<code>key</code>に利用しました。</p> <div class="custom-block tip"><p class="custom-block-title">keyという特殊なプロパティ</p> <p><code>key</code>はReactのJSXの中で配列を扱うときに必要となるプロパティで、要素のトラッキングのために利用されます。
配列の要素が更新された場合にDOMに正しくその更新を反映させるために使用されます。
コンポーネント側にはプロパティとして特に定義されている必要はありません。</p> <p>参考: <a href="https://ja.react.dev/learn/rendering-lists#keeping-list-items-in-order-with-key" target="_blank" rel="noopener noreferrer">ja.react.dev - リストのレンダー<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <h3 id="条件分岐で描画内容を変更する"><a href="#条件分岐で描画内容を変更する" class="header-anchor">#</a> 条件分岐で描画内容を変更する</h3> <p>繰り返し処理の次は条件分岐を実装してみましょう。</p> <p>以下のように<code>App.tsx</code>を書き換えてください。</p> <div class="language-tsx line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">type</span> <span class="token class-name">HelloProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  yourName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Hello</span><span class="token punctuation">(</span><span class="token punctuation">{</span> yourName <span class="token punctuation">}</span><span class="token operator">:</span> HelloProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>yourName<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        こんにちは、</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>yourName<span class="token punctuation">}</span><span class="token plain-text">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      Hello, </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>yourName<span class="token punctuation">}</span><span class="token plain-text">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> members <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;asa-taka&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;igarashi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ueda&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>members<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Hello</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>member<span class="token punctuation">}</span></span> <span class="token attr-name">yourName</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>member<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>成功すると以下のように、名前が5文字よりも長いメンバーに対しては「Hello」の代わりに「こんにちは」と表示されるようになります😉</p> <p><img src="/bootcamp/assets/img/ex-props6.a54170ca.png" alt=""></p> <p>さて、この書き方でも良いのですが、JSXの中で三項演算子<code>?:</code>を利用するともう少しシンプルに書けます。</p> <p>以下のように<code>App.tsx</code>を書き換えてください。</p> <div class="language-tsx line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">type</span> <span class="token class-name">HelloProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  yourName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Hello</span><span class="token punctuation">(</span><span class="token punctuation">{</span> yourName <span class="token punctuation">}</span><span class="token operator">:</span> HelloProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>yourName<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">5</span> <span class="token operator">?</span> <span class="token string">&quot;こんにちは、&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Hello, &quot;</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>yourName<span class="token punctuation">}</span><span class="token plain-text">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> members <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;asa-taka&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;igarashi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ueda&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>members<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Hello</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>member<span class="token punctuation">}</span></span> <span class="token attr-name">yourName</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>member<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>すっきりしましたね😉</p> <p>常にこの書き方が読みやすいとは限らないので、状況に応じて可読性の高い方を選んでください。</p> <h3 id="🚩チェックポイント-3"><a href="#🚩チェックポイント-3" class="header-anchor">#</a> 🚩チェックポイント</h3> <p>ここまでで、以下のことが理解できていると素晴らしいです😉</p> <ul><li>Reactでは<strong>プロパティ</strong>を受け取り<strong>JSX要素</strong>を返す<strong>関数</strong>を<strong>コンポーネント</strong>として定義し、画面を構成する</li> <li>プロパティを利用することでコンポーネントの表示内容にバリエーションを持たせ、汎用性を高められる</li> <li>繰り返し処理や条件分岐を利用することで効率的に画面を構成することができる</li></ul> <h2 id="stateとその変更に対するリアクティブな動作"><a href="#stateとその変更に対するリアクティブな動作" class="header-anchor">#</a> Stateとその変更に対するリアクティブな動作</h2> <p>ここまでの内容でReactのコンポーネントの基本的な表現を理解してもらえたと思います。
ただし、ここまでは単なるテンプレートエンジン的な処理しかしておらず、実はちょっとした便利関数を書けばブラウザのDOM APIでも同じようなことはできてしまいます。</p> <p>ここからはReactの真骨頂である <strong>「データの変更に応じて描画内容が変わる」</strong> というリアクティブな描画更新処理を体感してもらいます。
そのためには <strong>State(状態)</strong> にまつわる処理と <strong>イベントハンドラ</strong> を理解する必要があります。</p> <p>少し難易度が増しますが、頑張ってついてきてください😉</p> <h3 id="カウンタプログラム"><a href="#カウンタプログラム" class="header-anchor">#</a> カウンタプログラム</h3> <p><strong>State(状態)</strong> という概念はReactに限らずいろんなフレームワークで取り扱われる概念です。
親から(プロパティなどで)渡される値<strong>ではなく</strong>、かつそのコンポーネントが動いている間に(ユーザとのやり取りの中などで)変化する値を <strong>コンポーネント自身</strong> で保持したい場合に使われます。</p> <p>…こんなことを言われてもピンとこないですよね。そのためのハンズオ😉(略)</p> <p>というわけで以下の「カウンタプログラム」で実際に動作を確かめて欲しいと思います。</p> <p>カウンタプログラムもReactに限らず、そのフレームワークでStateがどのように実現されているかをデモするためによく使われます。
動作としてはシンプルで、ボタンを押すとカウンタの値が1つずつ増えていくというものです。</p> <p><code>App.tsx</code>を<strong>丸ごと書き換えて</strong>、以下のようにしてください。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">+1</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">count: </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Counter</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>ボタンを押すごとに値が「1→2→3→...」のように増えていけば成功です😉</p> <p><img src="/bootcamp/assets/img/ex-state1.b196d849.png" alt=""></p> <p>新しく登場した<code>useState</code>と <strong>イベントハンドラ</strong> について少し詳しく説明しましょう。</p> <p>Reactコンポーネントでは、自身で値を保持する場合、値が更新された場合に描画内容が再評価される必要があるため、そのための仕組みとして<code>useState</code>を利用します。
<code>useState</code>は初期状態を引数(ここでは<code>0</code>)で渡し、状態の値(ここでは<code>count</code>)と状態を更新するための関数(ここでは<code>setCount</code>)を返します。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>この方法で定義した<code>setCount</code>は、呼ばれるたびにコンポーネントの再評価のトリガーとなります。
これにより<code>count</code>が更新された状態でコンポーネントが再評価され、コンポーネントの返す値の変化をReactが検知することで描画内容の更新が行われます。</p> <div class="custom-block tip"><p class="custom-block-title">分割代入</p> <p>ちなみにこの変数の宣言方法は、配列の1番目の要素と2番目の要素をそれぞれ代入するという便利な書き方で、
<a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" target="_blank" rel="noopener noreferrer">分割代入(destructuring assignment)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>と呼ばれます。</p></div> <p>状態を更新する手段を手にしたので、次にそれをユーザの操作により実行するためのReactにおける <strong>イベントハンドラ</strong> の説明をしましょう。
といってもDOMのイベントハンドラとほぼ同じように扱えます。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">+1</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>onClick</code>には<code>button</code>がクリックされた際に評価される任意の関数を書くことができ、ここでは<code>setCount(count + 1)</code>を渡すことで、ボタンを押すたびに<code>count</code>の値を増やす処理をしています。</p> <p>描画が更新される流れをまとめると以下のようになります。</p> <ol><li><code>button</code>をクリックする</li> <li><code>onClick</code>の<code>setCount(count + 1)</code>が実行される</li> <li><code>setCount</code>が実行されたことによりコンポーネントが再評価される</li> <li>コンポーネントが返す内容が変わったことをReactが検知する</li> <li>それに合わせてブラウザの描画内容が更新される</li></ol> <p>初めは難しいと思うので <strong>「コンポーネントで値を保持したい場合は<code>useState</code>を使い、値の更新には第2引数の関数を使えば描画内容も更新される」</strong> とだけ覚えておけば十分です。</p> <p>この<code>useState</code>とイベントハンドラによる描画内容のリアクティブな更新パターンは、Reactによるアプリを作る上でいろんな形で現れるため、しっかり慣れ親しめるといいですね😉</p> <div class="custom-block tip"><p class="custom-block-title">State(状態)の具体例</p> <p>状態と言われても何が状態になりうるのかピンとこない人も多いと思いますので、具体例をいくつか挙げておきます。</p> <ul><li>UIの状態: パネルの開閉状態、フィルタ条件、input要素の値、など</li> <li>データの取得状態: サーバから取得したデータ自体、取得に失敗した場合のエラー、取得中か否か、など</li></ul> <p>これらの状態を保持するのにも一般的に<code>useState</code>が使われます。</p></div> <div class="custom-block tip"><p class="custom-block-title">useStateのようなものが必要となる理由をもう少し詳しく説明するなら</p> <p>Reactのコンポーネントは一般的に、アプリが実行されている間に何度も関数として評価されます。
具体的には親コンポーネントが再評価された場合や、自身に渡されるプロパティが変更された場合に再評価されます。
その再評価を跨いでオブジェクトや文字列、数値などの値を保持したい場合に<code>useState</code>を利用します。
これだけなら関数のスコープ外の適当な変数に値を保持することも考えられますが、その変更を検知して再評価する必要があるため<code>useState</code>のようなものが必要となります。</p> <p>ただし、フレームワークは使って覚えるものなので、今はこういった詳細を把握する必要はありません。</p></div> <h3 id="文字列のstateとonchange"><a href="#文字列のstateとonchange" class="header-anchor">#</a> 文字列のStateとonChange</h3> <p>カウンタプログラムでは実際に作るアプリのイメージが湧きづらいと思いますので、今度は入力された文字列をStateとして保持するパターンを見てみましょう。</p> <p><code>App.tsx</code>を<strong>丸ごと</strong>、以下のように書き換えてください。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">TextInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setText</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">input: </span><span class="token punctuation">{</span>text<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TextInput</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>入力欄に入力された値が下にそのまま表示されていれば成功です😉</p> <p><img src="/bootcamp/assets/img/ex-state2.8524864c.png" alt=""></p> <p>カウンタプログラムではクリックが起きたことのみを検知すれば十分だったため<code>() =&gt;</code>という書き方をしていましたが、
今回は<code>(event) =&gt;</code>という書き方をしており、これによりイベントの送信元(この場合は<code>input</code>要素)の情報を参照することができます。
<code>event.target</code>はイベントの送信元である<code>input</code>要素を表し、さらにその<code>value</code>属性で入力された値が取得できるため、<code>event.target.value</code>で入力値を取得しています。</p> <p>イベントハンドラにもいろんな種類があり、<code>onChange</code>は入力欄の値が変わった場合に毎回実行され、この場合はキーによる入力が行われるごとに実行されます。
<code>useState</code>は今回は文字列を保持するものとして定義しており、<code>setText(event.target.value)</code>を渡すことで、入力欄の値をStateとして保持しています。</p> <div class="custom-block tip"><p class="custom-block-title">Reactには双方向バインディングがない</p> <p>ReactにはVueJSやSvelteのような双方向バインディングがないため「<code>input</code>要素の値」のような、素朴な感覚ではその<code>input</code>要素自身が持っていそうなStateを親コンポーネントが参照する場合には、(プロパティ経由で)そのStateの管理を親コンポーネントが担う必要があります。</p> <p>今回のコードの場合は<code>input</code>が「何を値として表示するか」と「その値を更新する手段」を親コンポーネントである<code>TextInput</code>が管理し、それを子コンポーネントである<code>input</code>要素に<code>value</code>と<code>onChange</code>プロパティで与えているという図式です。</p> <p><a href="https://ja.react.dev/learn/sharing-state-between-components#controlled-and-uncontrolled-components" target="_blank" rel="noopener noreferrer">制御されたコンポーネントと非制御コンポーネント<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
の言葉を使うなら、これは「制御されたコンポーネント」のパターンになります。</p></div> <h3 id="フィルタ処理で見るもっとリアクティブな例"><a href="#フィルタ処理で見るもっとリアクティブな例" class="header-anchor">#</a> フィルタ処理で見るもっとリアクティブな例</h3> <p>今の段階の知識で理解できる、ちょっと実践的な実装パターンとして「リストのフィルタ処理」を書いてみましょう😉</p> <p>以下の2つのメソッドを利用することで、意外とシンプルに実装できてしまいます。</p> <ul><li>配列の<a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/filter" target="_blank" rel="noopener noreferrer"><code>filter</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>メソッド
<ul><li>各要素に対して関数を適用して、関数が<code>true</code>を返すもののみを含んだ新しい配列を返す</li></ul></li> <li>文字列の<a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/String/includes" target="_blank" rel="noopener noreferrer"><code>includes</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>メソッド
<ul><li>文字列が部分文字列を含む場合に<code>true</code>を返す</li></ul></li></ul> <p>これらを利用して<code>App.tsx</code>を<strong>丸ごと</strong>以下のように書き換えてください。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">ListFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> members <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;asa-taka&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;igarashi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ueda&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> filteredMembers <span class="token operator">=</span> members<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> member<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setText</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>filteredMembers<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>member<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>member<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ListFilter</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>入力欄に適当な文字列を入力すると、それを含む要素だけが下に表示されるようになれば成功です😉</p> <p><img src="/bootcamp/assets/img/ex-state3.90ef5ad0.png" alt=""></p> <p>例えば<code>as</code>と入力するとその文字列を含む<code>asa-taka</code>と<code>igarashi</code>が表示されます。
これはシンプルな検索機能として有用な実装パターンです。</p> <p><code>members.filter</code>に、各要素が<code>text</code>(入力欄の値)を部分文字列として含む場合に<code>true</code>を返す関数を渡すことで実現しています。</p> <p>これができたら更に以下のように書き換えてみてください。</p> <p>フィルタの対象となるリストを<code>members</code>プロパティとして渡せるようにしています。
プロパティの選び方によりコンポーネントの汎用性を高められることがわかると思います。</p> <div class="language-tsx line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">ListFilterProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  members<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">ListFilter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> members <span class="token punctuation">}</span><span class="token operator">:</span> ListFilterProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> filteredMembers <span class="token operator">=</span> members<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> member<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setText</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>filteredMembers<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>member<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>member<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ListFilter</span></span> <span class="token attr-name">members</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">&quot;asa-taka&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;igarashi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ueda&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ListFilter</span></span> <span class="token attr-name">members</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">&quot;endo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ogata&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;kataoka&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>表示は以下のようになれば成功です😉</p> <p><img src="/bootcamp/assets/img/ex-state4.ba0526d2.png" alt=""></p> <p>こうすることで<code>ListFilter</code>コンポーネントは「リストを表示して、それを検索するための入力欄も表示したい」という場合に汎用的に利用できるコンポーネントになりました。</p> <p>ここまでの内容で、プロパティとState、イベントハンドラを利用して、なんとなくリアクティブに動作する例を紹介してきました。
だんだんと「自分でもアプリが作れるかもしれないな…🤔」と感じてもらえると嬉しいです。</p> <h3 id="🚩チェックポイント-4"><a href="#🚩チェックポイント-4" class="header-anchor">#</a> 🚩チェックポイント</h3> <p>ここまでで、以下のことが理解できていると素晴らしいです😉</p> <ul><li><code>useState</code>を利用するとコンポーネントに <strong>State(状態)</strong> を持たせることができる</li> <li>Stateと<strong>イベントハンドラ</strong>を組み合わせることで、<strong>ユーザの操作に対してリアクティブ</strong>な動作を実装することができる</li></ul> <div class="custom-block tip"><p class="custom-block-title">⛳️初心者の人向けのゴール</p> <p>プログラミング初心者の方はここまでついてくるだけでも大変だったかもしれません。
よく頑張りましたね😉</p></div> <h2 id="todoアプリ"><a href="#todoアプリ" class="header-anchor">#</a> ToDoアプリ</h2> <p>さて、ここからはもう少し実践的な複雑さを持ったアプリとしてToDoアプリを作っていきましょう。
完成すると以下のような動作をするアプリになります。</p> <p><img src="/bootcamp/assets/img/todo.6f048801.gif" alt=""></p> <p>これを実装するために、ここまでに学んできたコンポーネントの切り分け、Stateやイベントハンドラ、フィルタ処理を全部使っていきましょう😉</p> <div class="custom-block tip"><p class="custom-block-title">ToDoアプリを作る意義</p> <p>新しくフレームワークを使おうとする場合、よく「ToDoアプリを作ると良い」と言われます(それをまとめた<a href="https://todomvc.com" target="_blank" rel="noopener noreferrer">ToDoMVC<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>というサイトもある)。</p> <p>理由としてはデータ操作に必要な「CRUD操作」を最小限の題材で網羅できるためだと思われます。</p> <p>CRUD操作とはデータに対する基本的な操作である、以下の4種類の操作の頭文字をとったものです。</p> <ul><li>Create: 新規作成</li> <li>Read: 閲覧</li> <li>Update: 更新・変更</li> <li>Delete: 削除</li></ul> <p>これらはAPIを設計する際やそれに対するフロントエンドを作成する際に基本となる考えになります。
例えばブログシステムを作ろうとする場合、記事に対するCRUD操作や、コメントに対するCRUD操作がそれぞれ必要になりそうだ、というように必要となる機能を洗い出すために参照できます。</p> <p>そしてこれらの操作に対してはそれぞれある程度決まった実装パターンがあるため、このCRUDという操作の分類は <strong>「この機能ははこんな感じに実装できる」</strong> という感覚を自身の中で体系化するためにも役立ちます。
このToDoアプリを実装することでそれらの実装パターンを体感してもらえると嬉しいです😉</p></div> <h3 id="フィルタ付きリストからtodoアプリの基礎を作る"><a href="#フィルタ付きリストからtodoアプリの基礎を作る" class="header-anchor">#</a> フィルタ付きリストからToDoアプリの基礎を作る</h3> <p>まずはスタート地点として以下のように<code>App.tsx</code>を<strong>丸ごと</strong>書き換えてください。
実装としてはフィルタ処理のものと比べてほぼ新しいことはしていないので、書き換えはコピペで済ませ「何をしていてどういう構成になっているか」の把握に時間を使って欲しいです。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token comment">/** リスト表示の対象となる、個々のToDoを表す型。*/</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">TodoItem</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/** 表示や操作の対象を識別するために利用する、全ての`TodoItem`の中で一意な値。 */</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token comment">/** ToDoの内容となる文字列。 */</span>
  text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/** 完了すると`true`となる。 */</span>
  done<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">TodoListItemProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  item<span class="token operator">:</span> TodoItem<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/** ToDoリストの個々のToDoとなるReactコンポーネント。 */</span>
<span class="token keyword">function</span> <span class="token function">TodoListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> item <span class="token punctuation">}</span><span class="token operator">:</span> TodoListItemProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>TodoItem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> textDecoration<span class="token operator">:</span> item<span class="token punctuation">.</span>done <span class="token operator">?</span> <span class="token string">&quot;line-through&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;none&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/** ToDoリストの初期値。 */</span>
<span class="token keyword">const</span> <span class="token constant">INITIAL_TODO</span><span class="token operator">:</span> TodoItem<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&quot;todo-item-1&quot;</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&quot;todo-item-2&quot;</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/** アプリケーション本体となるReactコンポーネント。 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> todoItems <span class="token operator">=</span> <span class="token constant">INITIAL_TODO</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>keyword<span class="token punctuation">,</span> setKeyword<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> filteredTodoItems <span class="token operator">=</span> todoItems<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> item<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ToDo</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App_todo-list-control<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
          <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>キーワードフィルタ<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>keyword<span class="token punctuation">}</span></span>
          <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setKeyword</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
        <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>filteredTodoItems<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dimmed<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">該当するToDoはありません</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App_todo-list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span>filteredTodoItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TodoListItem</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span> <span class="token attr-name">item</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><p>表示としては以下のようになっていれば想定通りです😉</p> <p><img src="/bootcamp/assets/img/todo1.8427f660.png" alt=""></p> <p>現時点での機能としては単純にフィルタ付きのリストです。</p> <p>ちょっとした新しいこととして<code>style</code>プロパティを利用して<code>item.done</code>が<code>true</code>の場合、つまりToDoが完了している場合に<code>text-decoration: line-throug</code>で取り消し線を表示するようにしています。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> textDecoration<span class="token operator">:</span> item<span class="token punctuation">.</span>done <span class="token operator">?</span> <span class="token string">&quot;line-through&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;none&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>他にはクラス指定によりスタイルを適用していますが、Reactの処理の本質とは離れるためここでは割愛します。</p> <h3 id="状態確認用コンポーネントを追加する"><a href="#状態確認用コンポーネントを追加する" class="header-anchor">#</a> 状態確認用コンポーネントを追加する</h3> <p>ここからは「コンポーネントが現在どのような値を持っているか」を確認できると理解がしやすいため、そのための状態確認用コンポーネント<code>ValueViewer</code>を追加します。</p> <div class="custom-block warning"><p class="custom-block-title">ここからはdiffコマンドによる差分表示</p> <p>ここからはコード量が増えてきたため、<code>diff</code>コマンドを利用した差分表示でコードの変更箇所を示します。
各行頭の<code>-</code>が削除してほしい行(赤)、<code>+</code>が追加してほしい行(緑)を表しているので、その通りに変更してください。</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> 削除してほしい行
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> 追加してほしい行
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>@@ -44,9 +50,13 @@</code>のような記述は<code>diff</code>コマンドによる位置表示の出力であり、数字は気にせず「行のまとまりの区切り」程度に捉えてください。</p> <p>コードの全体像を確認したい場合は <a href="https://github.com/asa-taka/bootcamp-todo/tree/main/src/todo" target="_blank" rel="noopener noreferrer">github.com/asa-taka/bootcamp-todo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> に各ステップのコードがまとめられているため、参考にしたり、どうしても動かなくなった場合はここからコピペをしてリカバリーしてください。</p></div> <p>以下のように<code>App.tsx</code>に<code>ValueViewer</code>を追加してください。</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token coord">@@ -25,6 +25,17 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  );
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">type ValueViewerProps = {
</span><span class="token prefix inserted">+</span><span class="token line">  value: any;
</span><span class="token prefix inserted">+</span><span class="token line">};
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">/** `value`の内容を`JSON.stringify`して表示する、動作確認用コンポーネント。 */
</span><span class="token prefix inserted">+</span><span class="token line">function ValueViewer({ value }: ValueViewerProps) {
</span><span class="token prefix inserted">+</span><span class="token line">  return (
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;pre className=&quot;ValueViewer&quot;&gt;{JSON.stringify(value, undefined, 2)}&lt;/pre&gt;
</span><span class="token prefix inserted">+</span><span class="token line">  );
</span><span class="token prefix inserted">+</span><span class="token line">}
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">/** ToDoリストの初期値。 */
</span><span class="token prefix unchanged"> </span><span class="token line">const INITIAL_TODO: TodoItem[] = [
</span><span class="token prefix unchanged"> </span><span class="token line">  { id: 1, text: &quot;todo-item-1&quot;, done: false },
</span></span><span class="token coord">@@ -59,6 +70,7 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">          ))}
</span><span class="token prefix unchanged"> </span><span class="token line">        &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">      )}
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;ValueViewer value={{ keyword, todoItems, filteredTodoItems }} /&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">  );
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>コード全体: <a href="https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step2.tsx" target="_blank" rel="noopener noreferrer">https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step2.tsx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ToDoリストの下にJSONが表示されれば成功です😉</p> <p><img src="/bootcamp/assets/img/todo2.2268f574.png" alt=""></p> <p>ここで定義した<code>ValueViewer</code>は<code>value</code>で渡された値を「整形されたJSON」として表示するコンポーネントです。</p> <div class="custom-block tip"><p class="custom-block-title">JSON</p> <p><a href="https://developer.mozilla.org/ja/docs/Learn/JavaScript/Objects/JSON" target="_blank" rel="noopener noreferrer">JSON<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>はJavaScriptに限らず幅広く利用される構造化データの記述方式です。
雑な表現をすると、ここでは「文字列化されたJavaScriptのオブジェクト」程度に考えてもらえれば十分です。
要は任意のデータを手軽に表示する手段として利用しているだけです。</p></div> <p>更に動作を確認するためにフィルタ入力欄を操作してみてください。
フィルタの文字列によってJSON内の<code>filteredTodoItems</code>が変わるとともに、表示されるToDoリストの要素が変わると思います。</p> <p>Reactがデータの変更に対して描画内容をリアクティブに更新するということを、これによりさらに体感してもらえると嬉しいです😉</p> <h3 id="データの更新処理-update-に対応する"><a href="#データの更新処理-update-に対応する" class="header-anchor">#</a> データの更新処理(Update)に対応する</h3> <p>ここまではフィルタ処理も含め「閲覧操作」の実装を行なってきました。
しかし、アプリケーションの実装の複雑さはデータの追加や更新などの「変更操作」によって生まれると言えます。</p> <p>つまりここを理解するには頭を使う必要があるかもしれませんが、理解に取り組んだ分「ちょっとできる人」になれるということです😉</p> <p>変更操作の手始めとして、CRUD操作ののUpdateに該当する「更新処理」を実装してみましょう。
具体的には<code>TodoListItem</code>のチェックボックスによりデータの<code>done</code>を操作することを可能にします。</p> <p><code>App.tsx</code>を以下のように変更してください。</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token coord">@@ -12,12 +12,18 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">type TodoListItemProps = {
</span><span class="token prefix unchanged"> </span><span class="token line">  item: TodoItem;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  onCheck: (checked: boolean) =&gt; void;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">/** ToDoリストの個々のToDoとなるReactコンポーネント。 */
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">function TodoListItem({ item }: TodoListItemProps) {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">function TodoListItem({ item, onCheck }: TodoListItemProps) {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return (
</span><span class="token prefix unchanged"> </span><span class="token line">    &lt;div className=&quot;TodoItem&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;input
</span><span class="token prefix inserted">+</span><span class="token line">        type=&quot;checkbox&quot;
</span><span class="token prefix inserted">+</span><span class="token line">        checked={item.done}
</span><span class="token prefix inserted">+</span><span class="token line">        onChange={(ev) =&gt; onCheck(ev.currentTarget.checked)}
</span><span class="token prefix inserted">+</span><span class="token line">      /&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">      &lt;p style={{ textDecoration: item.done ? &quot;line-through&quot; : &quot;none&quot; }}&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">        {item.text}
</span><span class="token prefix unchanged"> </span><span class="token line">      &lt;/p&gt;
</span></span><span class="token coord">@@ -44,9 +50,15 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">/** アプリケーション本体となるReactコンポーネント。 */
</span><span class="token prefix unchanged"> </span><span class="token line">export default function App() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  const todoItems = INITIAL_TODO;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const [todoItems, setTodoItems] = useState(INITIAL_TODO);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  const [keyword, setKeyword] = useState(&quot;&quot;);
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const updateItem = (newItem: TodoItem) =&gt; {
</span><span class="token prefix inserted">+</span><span class="token line">    setTodoItems(
</span><span class="token prefix inserted">+</span><span class="token line">      todoItems.map((item) =&gt; (item.id === newItem.id ? newItem : item)),
</span><span class="token prefix inserted">+</span><span class="token line">    );
</span><span class="token prefix inserted">+</span><span class="token line">  };
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  const filteredTodoItems = todoItems.filter((item) =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">    return item.text.includes(keyword);
</span><span class="token prefix unchanged"> </span><span class="token line">  });
</span></span><span class="token coord">@@ -66,7 +78,13 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">      ) : (
</span><span class="token prefix unchanged"> </span><span class="token line">        &lt;div className=&quot;App_todo-list&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">          {filteredTodoItems.map((item) =&gt; (
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">            &lt;TodoListItem key={item.id} item={item} /&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            &lt;TodoListItem
</span><span class="token prefix inserted">+</span><span class="token line">              key={item.id}
</span><span class="token prefix inserted">+</span><span class="token line">              item={item}
</span><span class="token prefix inserted">+</span><span class="token line">              onCheck={(checked) =&gt; {
</span><span class="token prefix inserted">+</span><span class="token line">                updateItem({ ...item, done: checked });
</span><span class="token prefix inserted">+</span><span class="token line">              }}
</span><span class="token prefix inserted">+</span><span class="token line">            /&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">          ))}
</span><span class="token prefix unchanged"> </span><span class="token line">        &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">      )}
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><p>コード全体: <a href="https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step3.tsx" target="_blank" rel="noopener noreferrer">https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step3.tsx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>動作としては前述の通り、チェックボックスにより<code>TodoItem</code>の<code>done</code>の値が変わり、それが表示に随時反映されていれば成功です😉</p> <p><code>ValueViewer</code>の値もぜひ観察してみてください。</p> <p><img src="/bootcamp/assets/img/todo3.c26f023d.png" alt=""></p> <p>チェックボタンが機能することで一気にToDoらしくなりましたね。</p> <p>いくつか説明が必要な箇所があると思いますので、ここでは一気に説明してしまいます。</p> <ul><li><code>todoItems</code>の定義に<code>useState</code>を使用した
<ul><li>ToDoのリストがが更新された際に表示を更新する必要があるためです</li> <li>つまり<code>App</code>コンポーネントが<code>todoItems</code>というStateを持ったということです</li></ul></li> <li><code>TodoListItem</code>に<code>onCheck</code>プロパティを追加した</li> <li><code>App</code>に<code>updateItem</code>を定義して<code>TodoListItem</code>の<code>onCheck</code>に渡した
<ul><li>実装としては<code>map</code>メソッドを利用し「<code>id</code>が一致するToDoを引数の<code>newItem</code>と入れ替えた新しい配列」でStateを更新しています</li></ul></li></ul> <p>この中で注目してほしいのは、<code>App</code>と<code>TodoListItem</code>というコンポーネントの親子関係の間でどのように役割が分担されているかということです。</p> <p>整理するとそれぞれ以下の役割を担っています。</p> <ul><li>親コンポーネントの役割(ここでは<code>App</code>)
<ul><li>Stateの管理(<code>useState</code>)とそれに対する処理(<code>updateItem</code>)を定義し、子コンポーネントにプロパティとして渡す</li></ul></li> <li>子コンポーネントの役割(ここでは<code>TodoListItem</code>)
<ul><li>チェックボックスや入力欄などの「イベントのソースとなる要素」を定義する</li> <li>その要素のイベントに対する処理をプロパティ(<code>onCheck</code>)として親から受け取り、イベントハンドラとして登録する
<ul><li>この際、親コンポーネントから扱いやすいように引数や返り値の変換も行なうことが多いです</li></ul></li></ul></li></ul> <p>Reactではこのパターンを基本としてアプリのパーツを作り、それらを組み合わせることで、ブラウザのDOM APIを直接触る場合とは比較にならないくらい複雑で細やかに画面が更新されるアプリを「整理された形で」構築することができます。</p> <div class="custom-block warning"><p class="custom-block-title">Stateの更新時には「入れ物」を更新しよう</p> <p><code>todoItems[id] = newItem</code>のように直接代入しないのは「それをするとReactの変更検知がうまく動かない」ためです。
詳しくは<a href="https://ja.react.dev/learn/updating-arrays-in-state" target="_blank" rel="noopener noreferrer">state 内の配列の更新<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を見てください。</p> <p>簡単なルールを紹介すると、配列やオブジェクトをStateで管理し更新する場合は「一番外側の入れ物」は新しいものにする必要があります(この表現でも難しいですよね…)</p> <p>今回の場合は<code>map</code>メソッドが新しい配列を返すものであるため、それを利用してStateを更新しています。</p></div> <h3 id="終了したtodoを非表示にするフィルタ条件を追加する"><a href="#終了したtodoを非表示にするフィルタ条件を追加する" class="header-anchor">#</a> 終了したToDoを非表示にするフィルタ条件を追加する</h3> <p><code>done</code>の更新処理が実装できたところで、次にそれに対するフィルタ条件を追加してみましょう。
更新処理の追加に比べれば小さい変更で実装できます。</p> <p>以下のように<code>App.tsx</code>を修正してください。</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token coord">@@ -52,6 +52,7 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">export default function App() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const [todoItems, setTodoItems] = useState(INITIAL_TODO);
</span><span class="token prefix unchanged"> </span><span class="token line">  const [keyword, setKeyword] = useState(&quot;&quot;);
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const [showingDone, setShowingDone] = useState(true);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  const updateItem = (newItem: TodoItem) =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">    setTodoItems(
</span></span><span class="token coord">@@ -60,6 +61,7 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  };
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  const filteredTodoItems = todoItems.filter((item) =&gt; {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    if (!showingDone &amp;&amp; item.done) return false;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    return item.text.includes(keyword);
</span><span class="token prefix unchanged"> </span><span class="token line">  });
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token coord">@@ -72,6 +74,13 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">          value={keyword}
</span><span class="token prefix unchanged"> </span><span class="token line">          onChange={(ev) =&gt; setKeyword(ev.target.value)}
</span><span class="token prefix unchanged"> </span><span class="token line">        /&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;input
</span><span class="token prefix inserted">+</span><span class="token line">          id=&quot;showing-done&quot;
</span><span class="token prefix inserted">+</span><span class="token line">          type=&quot;checkbox&quot;
</span><span class="token prefix inserted">+</span><span class="token line">          checked={showingDone}
</span><span class="token prefix inserted">+</span><span class="token line">          onChange={(ev) =&gt; setShowingDone(ev.target.checked)}
</span><span class="token prefix inserted">+</span><span class="token line">        /&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;label htmlFor=&quot;showing-done&quot;&gt;完了したものも表示する&lt;/label&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">      &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">      {filteredTodoItems.length === 0 ? (
</span><span class="token prefix unchanged"> </span><span class="token line">        &lt;div className=&quot;dimmed&quot;&gt;該当するToDoはありません&lt;/div&gt;
</span></span><span class="token coord">@@ -88,7 +97,9 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">          ))}
</span><span class="token prefix unchanged"> </span><span class="token line">        &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">      )}
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">      &lt;ValueViewer value={{ keyword, todoItems, filteredTodoItems }} /&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;ValueViewer
</span><span class="token prefix inserted">+</span><span class="token line">        value={{ keyword, showingDone, todoItems, filteredTodoItems }}
</span><span class="token prefix inserted">+</span><span class="token line">      /&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">  );
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>コード全体: <a href="https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step4.tsx" target="_blank" rel="noopener noreferrer">https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step4.tsx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>これにより「完了したものも表示する」というチェックボックスが追加され、そのチェック状態によりその通りリストの表示状態が更新されれば期待通りです😉</p> <p><img src="/bootcamp/assets/img/todo4.9d19d049.png" alt=""></p> <p>やっていることは新しいフィルタ条件用チェックボックスの状態を保持する<code>useState</code>と、それを参照するフィルタ関数の処理の追加のみであるため説明は省略します。</p> <h3 id="データの追加処理-create-に対応する"><a href="#データの追加処理-create-に対応する" class="header-anchor">#</a> データの追加処理(Create)に対応する</h3> <p>どんどんいきましょう。次は新しくToDoを追加するための<code>CreateTodoForm</code>を追加しましょう。</p> <p>以下のように<code>App.tsx</code>を編集してください。</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token coord">@@ -31,6 +31,26 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  );
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">type CreateTodoFormProps = {
</span><span class="token prefix inserted">+</span><span class="token line">  onSubmit: (text: string) =&gt; void;
</span><span class="token prefix inserted">+</span><span class="token line">};
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">/** 新しくToDoを追加するためのフォームとなるReactコンポーネント。 */
</span><span class="token prefix inserted">+</span><span class="token line">function CreateTodoForm({ onSubmit }: CreateTodoFormProps) {
</span><span class="token prefix inserted">+</span><span class="token line">  const [text, setText] = useState(&quot;&quot;);
</span><span class="token prefix inserted">+</span><span class="token line">  return (
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;div className=&quot;CreateTodoForm&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;input
</span><span class="token prefix inserted">+</span><span class="token line">        placeholder=&quot;新しいTodo&quot;
</span><span class="token prefix inserted">+</span><span class="token line">        size={60}
</span><span class="token prefix inserted">+</span><span class="token line">        value={text}
</span><span class="token prefix inserted">+</span><span class="token line">        onChange={(ev) =&gt; setText(ev.currentTarget.value)}
</span><span class="token prefix inserted">+</span><span class="token line">      /&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;button onClick={() =&gt; onSubmit(text)}&gt;追加&lt;/button&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;/div&gt;
</span><span class="token prefix inserted">+</span><span class="token line">  );
</span><span class="token prefix inserted">+</span><span class="token line">}
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">type ValueViewerProps = {
</span><span class="token prefix unchanged"> </span><span class="token line">  value: any;
</span><span class="token prefix unchanged"> </span><span class="token line">};
</span></span><span class="token coord">@@ -48,12 +68,22 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  { id: 2, text: &quot;todo-item-2&quot;, done: true },
</span><span class="token prefix unchanged"> </span><span class="token line">];
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">/**
</span><span class="token prefix inserted">+</span><span class="token line"> * ID用途に重複しなさそうな数値を適当に生成する。
</span><span class="token prefix inserted">+</span><span class="token line"> * 今回は適当にUnix Epoch(1970-01-01)からの経過ミリ秒を利用した。
</span><span class="token prefix inserted">+</span><span class="token line"> */
</span><span class="token prefix inserted">+</span><span class="token line">const generateId = () =&gt; Date.now();
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">/** アプリケーション本体となるReactコンポーネント。 */
</span><span class="token prefix unchanged"> </span><span class="token line">export default function App() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const [todoItems, setTodoItems] = useState(INITIAL_TODO);
</span><span class="token prefix unchanged"> </span><span class="token line">  const [keyword, setKeyword] = useState(&quot;&quot;);
</span><span class="token prefix unchanged"> </span><span class="token line">  const [showingDone, setShowingDone] = useState(true);
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const createItem = (text: string) =&gt; {
</span><span class="token prefix inserted">+</span><span class="token line">    setTodoItems([...todoItems, { id: generateId(), text, done: false }]);
</span><span class="token prefix inserted">+</span><span class="token line">  };
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  const updateItem = (newItem: TodoItem) =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">    setTodoItems(
</span><span class="token prefix unchanged"> </span><span class="token line">      todoItems.map((item) =&gt; (item.id === newItem.id ? newItem : item)),
</span></span><span class="token coord">@@ -97,6 +127,7 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">          ))}
</span><span class="token prefix unchanged"> </span><span class="token line">        &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">      )}
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;CreateTodoForm onSubmit={(text) =&gt; createItem(text)} /&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">      &lt;ValueViewer
</span><span class="token prefix unchanged"> </span><span class="token line">        value={{ keyword, showingDone, todoItems, filteredTodoItems }}
</span><span class="token prefix unchanged"> </span><span class="token line">      /&gt;
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><p>コード全体: <a href="https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step5.tsx" target="_blank" rel="noopener noreferrer">https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step5.tsx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>以下のように「新しいToDo」という入力欄が表示され、テキストを入力し追加ボタンを押すと新しいToDoが追加されれば成功です😉</p> <p><img src="/bootcamp/assets/img/todo5.6907283a.png" alt=""></p> <p><code>ValueViewer</code>で見ても<code>todoItems</code>に新しいToDoが追加されたのがわかると思います。</p> <p>これで最低限、ToDoアプリとして動作するようになりましたね。</p> <p><code>generateId</code>は<code>map</code>関数で利用する<code>key</code>として使うための値を生成するものです。
他の点は更新処理の実装時と比べて新しいことはしていないため説明を省略します。</p> <div class="custom-block tip"><p class="custom-block-title">スプレッド演算子(`...`)</p> <p><code>...</code>は「スプレッド演算子」と呼ばれ、配列の中身を別の配列の中に展開することができます。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> newList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>list<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newList<span class="token punctuation">)</span>
<span class="token comment">// =&gt; [ 1, 2, 3, 4, 5 ]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>同様にオブジェクトに対しても以下のように働きます。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token string">'foo'</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>obj<span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">99</span> <span class="token punctuation">}</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">)</span>
<span class="token comment">// =&gt; { a: 12, b: 'foo', c: 99 }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>これらを利用することで他の要素を引き継ぎ、特定の要素のみを更新・追加した、<strong>新しい</strong> 配列やオブジェクトを作ることができます。</p> <p>Reactでは先述の通り、変更検知の都合上、状態を更新するときには「入れ物」を新しく作り直す必要があるためこの表現がよく使われます。</p> <p>参考: <a href="https://ja.react.dev/learn/updating-objects-in-state#copying-objects-with-the-spread-syntax" target="_blank" rel="noopener noreferrer">スプレッド構文を使ったオブジェクトのコピー<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <h3 id="状態とそれに対する操作をカスタムhookとしてまとめる"><a href="#状態とそれに対する操作をカスタムhookとしてまとめる" class="header-anchor">#</a> 状態とそれに対する操作をカスタムHookとしてまとめる</h3> <p>さて、<code>App</code>コンポーネントの実装が増えてきたため、ある程度の塊で処理を分割したいと思います。</p> <p>これまでに何度も利用してきましたが<code>useState</code>は<a href="https://ja.react.dev/reference/react" target="_blank" rel="noopener noreferrer">React Hook<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>と呼ばれるものの一つです。
Hookの詳細は省きますが、ここでは「Reactコンポーネントの中だけで使える特殊な関数」という理解で十分です。
詳細はリンク先を確認してください。</p> <p>そしてReactではHookをまとめて独自のHookを定義でき、これをカスタムHookと呼びます。
Reactではこれを利用し「状態とそれに対する操作」をまとめてカスタムHookとして定義し、処理をまとめるということをよくやります。</p> <p>ここでは<code>todoItems</code>とそれに対する操作をカスタムHookとしてまとめたいと思います。</p> <p><code>App.tsx</code>を以下のように変更してください。</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token coord">@@ -74,6 +74,20 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> */
</span><span class="token prefix unchanged"> </span><span class="token line">const generateId = () =&gt; Date.now();
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">/** ToDoのStateとそれに対する操作をまとめたカスタムHook。 */
</span><span class="token prefix inserted">+</span><span class="token line">const useTodoState = () =&gt; {
</span><span class="token prefix inserted">+</span><span class="token line">  const [todoItems, setTodoItems] = useState(INITIAL_TODO);
</span><span class="token prefix inserted">+</span><span class="token line">  const createItem = (text: string) =&gt; {
</span><span class="token prefix inserted">+</span><span class="token line">    setTodoItems([...todoItems, { id: generateId(), text, done: false }]);
</span><span class="token prefix inserted">+</span><span class="token line">  };
</span><span class="token prefix inserted">+</span><span class="token line">  const updateItem = (newItem: TodoItem) =&gt; {
</span><span class="token prefix inserted">+</span><span class="token line">    setTodoItems(
</span><span class="token prefix inserted">+</span><span class="token line">      todoItems.map((item) =&gt; (item.id === newItem.id ? newItem : item)),
</span><span class="token prefix inserted">+</span><span class="token line">    );
</span><span class="token prefix inserted">+</span><span class="token line">  };
</span><span class="token prefix inserted">+</span><span class="token line">  return [todoItems, createItem, updateItem] as const;
</span><span class="token prefix inserted">+</span><span class="token line">};
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token coord">@@ -84,20 +98,10 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">/** アプリケーション本体となるReactコンポーネント。 */
</span><span class="token prefix unchanged"> </span><span class="token line">export default function App() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  const [todoItems, setTodoItems] = useState(INITIAL_TODO);
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const [todoItems, createItem, updateItem] = useTodoState();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  const [keyword, setKeyword] = useState(&quot;&quot;);
</span><span class="token prefix unchanged"> </span><span class="token line">  const [showingDone, setShowingDone] = useState(true);
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  const createItem = (text: string) =&gt; {
</span><span class="token prefix deleted">-</span><span class="token line">    setTodoItems([...todoItems, { id: generateId(), text, done: false }]);
</span><span class="token prefix deleted">-</span><span class="token line">  };
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">  const updateItem = (newItem: TodoItem) =&gt; {
</span><span class="token prefix deleted">-</span><span class="token line">    setTodoItems(
</span><span class="token prefix deleted">-</span><span class="token line">      todoItems.map((item) =&gt; (item.id === newItem.id ? newItem : item)),
</span><span class="token prefix deleted">-</span><span class="token line">    );
</span><span class="token prefix deleted">-</span><span class="token line">  };
</span><span class="token prefix deleted">-</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  const filteredTodoItems = todoItems.filter((item) =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">    if (!showingDone &amp;&amp; item.done) return false;
</span><span class="token prefix unchanged"> </span><span class="token line">    return item.text.includes(keyword);
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>コード全体: <a href="https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step6.tsx" target="_blank" rel="noopener noreferrer">https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step6.tsx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>この変更では表示内容は変わりません。</p> <p>ここでは<code>todoItems</code>と<code>createItem</code>と<code>updateItem</code>を<code>useTodoState</code>という名前の関数でまとめました。
この<code>use***</code>というのは内部でReact Hookを使っていることをわかりやすくするためのただの命名規則で、実質カスタムHookというのはHookを含んでいるだけのただの関数です。</p> <p>ひとつ注目して欲しいのは、この切り出しにより<code>setTodoItems</code>というメソッドが<code>App</code>コンポーネントからはアクセスできなくなった点です。
<code>setTodoItems</code>は<code>todoItems</code>に対しては、いわばどのような変更も行える万能メソッドです。
それを隠蔽し、追加や変更など、ある特定の操作に特化したメソッドのみを利用者側に見せることで、そのStateがどのような変更操作を意図しているのかを明確にし、コードの可読性を上げることができます。</p> <p>「Stateとそれに対する操作をまとめる」というパターンはよく使うため覚えておくと良いでしょう😉</p> <h3 id="データの削除処理-delete-に対応する"><a href="#データの削除処理-delete-に対応する" class="header-anchor">#</a> データの削除処理(Delete)に対応する</h3> <p>最後に残りのCRUD操作である削除(Delete)処理を実装します。
データに対する削除操作は概ね「削除ボタン」として実装されることが多いです。
ここでも「削除ボタン」として実装しましょう。</p> <p>方針としては<code>TodoListItem</code>に<code>onCheck</code>を追加した時と同じように<code>onDelete</code>プロパティを追加します。
以下のように<code>App.tsx</code>を修正ししてください。</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token coord">@@ -13,10 +13,11 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">type TodoListItemProps = {
</span><span class="token prefix unchanged"> </span><span class="token line">  item: TodoItem;
</span><span class="token prefix unchanged"> </span><span class="token line">  onCheck: (checked: boolean) =&gt; void;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  onDelete: () =&gt; void;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">/** ToDoリストの個々のToDoとなるReactコンポーネント。 */
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">function TodoListItem({ item, onCheck }: TodoListItemProps) {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">function TodoListItem({ item, onCheck, onDelete }: TodoListItemProps) {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return (
</span><span class="token prefix unchanged"> </span><span class="token line">    &lt;div className=&quot;TodoItem&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">      &lt;input
</span></span><span class="token coord">@@ -27,6 +28,9 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">      &lt;p style={{ textDecoration: item.done ? &quot;line-through&quot; : &quot;none&quot; }}&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">        {item.text}
</span><span class="token prefix unchanged"> </span><span class="token line">      &lt;/p&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;button className=&quot;button-small&quot; onClick={() =&gt; onDelete()}&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        ×
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;/button&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">  );
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span></span><span class="token coord">@@ -85,12 +89,15 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">      todoItems.map((item) =&gt; (item.id === newItem.id ? newItem : item)),
</span><span class="token prefix unchanged"> </span><span class="token line">    );
</span><span class="token prefix unchanged"> </span><span class="token line">  };
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const deleteItem = (id: number) =&gt; {
</span><span class="token prefix inserted">+</span><span class="token line">    setTodoItems(todoItems.filter((item) =&gt; item.id !== id));
</span><span class="token prefix inserted">+</span><span class="token line">  };
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  return [todoItems, createItem, updateItem] as const;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  return [todoItems, createItem, updateItem, deleteItem] as const;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">/** アプリケーション本体となるReactコンポーネント。 */
</span><span class="token prefix unchanged"> </span><span class="token line">export default function App() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  const [todoItems, createItem, updateItem] = useTodoState();
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const [todoItems, createItem, updateItem, deleteItem] = useTodoState();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  const [keyword, setKeyword] = useState(&quot;&quot;);
</span><span class="token prefix unchanged"> </span><span class="token line">  const [showingDone, setShowingDone] = useState(true);
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token coord">@@ -127,6 +134,7 @@</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">              onCheck={(checked) =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">                updateItem({ ...item, done: checked });
</span><span class="token prefix unchanged"> </span><span class="token line">              }}
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              onDelete={() =&gt; deleteItem(item.id)}
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">            /&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">          ))}
</span><span class="token prefix unchanged"> </span><span class="token line">        &lt;/div&gt;
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p>コード全体: <a href="https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step-final.tsx" target="_blank" rel="noopener noreferrer">https://github.com/asa-taka/bootcamp-todo/blob/main/src/todo/step-final.tsx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>以下のように各ToDoに削除ボタンがついて、ボタンを押してその項目が削除されれば想定通りです😉</p> <p><img src="/bootcamp/assets/img/todo-final.e26e682d.png" alt=""></p> <p><code>ValueViewer</code>で<code>todoItems</code>を見てもそのデータが消えているのがわかると思います。</p> <p>以上でToDoアプリの一通りの実装ができました。やったね。</p> <h3 id="🚩チェックポイント-5"><a href="#🚩チェックポイント-5" class="header-anchor">#</a> 🚩チェックポイント</h3> <p>ここまでで、以下のReactにおける実装パターンを学べていると良いでしょう。</p> <ul><li>CRUD操作のそれぞれに対応する実装パターン
<ul><li>ここで紹介した以外にもたくさんの実装パターンがあります</li></ul></li> <li>Stateとそれに対する操作手段をカスタムHookとしてまとめる</li> <li>親コンポーネントではStateとそれに対する操作手段を、子コンポーネントではイベントのソースとなる要素とそのハンドラへの処理の登録をそれぞれ分担する
<ul><li>ただしなんでもかんでも親がStateを持てばいいというわけではないのが難しいところです</li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">⛳️通常のゴール</p> <p>もし2時間でここまでついて来れていたら大したものです。お疲れ様でした😉</p></div> <h3 id="発展課題"><a href="#発展課題" class="header-anchor">#</a> 発展課題</h3> <p>時間に余裕があれば挑戦してみてください。
この先の「APIサーバとのやりとりを行うToDoアプリ」に進んでも構いません。</p> <ul><li><a href="https://developer.mozilla.org/ja/docs/Web/API/Window/localStorage" target="_blank" rel="noopener noreferrer"><code>localStorage</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を利用してリロードしても変更した内容が保たれるようにしよう
<ul><li>現在の実装ではリロードすると値が消えてしまいますが、ブラウザには<code>localStorage</code>という値の保存場所があります</li> <li><code>localStorage</code>には文字列しか格納できないため、任意のデータを保存する場合は、保存する前には<code>JSON.stringify</code>で文字列にし、取り出した後には<code>JSON.parse</code>でJavaScriptの値(オブジェクト・数値・文字列・etc)として変換します
<ul><li>こういう文字列変換する処理をシリアライズ、その逆変換をデシリアライズという言います</li></ul></li> <li>これができると、自分の手元で動作すればいいだけのアプリであればグッと実用性が増します</li></ul></li> <li><code>CreateItemForm</code>の入力後に入力欄の値がクリアされるようにしてみよう
<ul><li>この方が使用感は上がると思います</li></ul></li> <li>削除処理の前に確認メッセージを入れてみよう
<ul><li><a href="https://developer.mozilla.org/ja/docs/Web/API/Window/confirm" target="_blank" rel="noopener noreferrer"><code>window.confirm</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>というブラウザ標準のAPIを使うと割と簡単に実装できます</li> <li>ただしToDoアプリ程度だと、毎回確認が入ると使用感が落ちるかもしれないですね</li></ul></li> <li>その他、好きに機能を拡張してみよう
<ul><li>ToDoに締切を入力できるようにする、など自由に機能を拡張してください</li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">まだまだ序の口 その1 - CRUD操作の奥深さ</p> <p>今回の講義ではシングルページで組むこととしたため、CRUD操作の実装パターンや悩みどころについては触れられていない部分が多いです。
実際<a href="https://reactrouter.com/en/main" target="_blank" rel="noopener noreferrer">React Router<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>などを使いマルチページにすることで、イベントハンドラでの連携や各操作のAPIレスポンスとして返されると嬉しい値など、ノウハウの貯めどころは格段に増えてきます。</p> <p>ただし大きなアプリの機能の一部として「リストをページ遷移なしで編集する」というケースは存在するため、その点ではToDoアプリも十分に応用しがいのある実装例と言えます。</p></div> <div class="custom-block tip"><p class="custom-block-title">まだまだ序の口 その2 - 実際のアプリに必要な要素</p> <p>ToDoアプリは基礎の一要素にはなりますが、より実践的なアプリを組む場合には不足している要素がたくさんあります。</p> <p>実践を考えると、例えば以下の要素が不足していると考えられます。</p> <ul><li>サーバとのやりとり
<ul><li>ブラウザを跨いだデータの永続化に必要になります</li> <li>ネットワーク越しにAPIを利用してCRUDやその他の操作を行う必要が出てきます</li> <li><code>Promise</code>などの非同期処理の理解やHTTPについての理解も必要になります</li></ul></li> <li>認証
<ul><li>社内で業務上の情報を扱うツールを作る場合は避けられないでしょう</li></ul></li> <li>ルーティングライブラリを利用したマルチページ化(react-routerなど)
<ul><li>擬似的に複数ページのアプリケーションを表現する技術です</li> <li>アプリ開発の世界ではURLと画面の対応付けのことを「ルーティング」と呼び、IPルーティングとは異なる概念です</li></ul></li></ul> <p><a href="https://react.dev/learn/start-a-new-react-project" target="_blank" rel="noopener noreferrer">最近のReact公式のチュートリアル<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>では<a href="https://nextjs.org" target="_blank" rel="noopener noreferrer">NextJS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>という統合的なフレームワークがプロジェクトを始める際の第一の選択肢として挙げられており、これは上に挙げた要素を含むものになっているため、触ってみると良いかもしれません(まだきちんと触ったことはないので自信はないです)。</p> <p>また、ToDoMVCのさらに発展版のような、<a href="https://codebase.show/projects/realworld" target="_blank" rel="noopener noreferrer">RealWorld<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>という、より実践的な要素を網羅した実装例をまとめたサイトもあるため、参考にするといいかもしれません(こちらも私はあまり見たことはないです)。</p></div> <h2 id="apiサーバとのやりとりを行うtodoアプリ"><a href="#apiサーバとのやりとりを行うtodoアプリ" class="header-anchor">#</a> APIサーバとのやりとりを行うToDoアプリ</h2> <div class="custom-block tip"><p class="custom-block-title">エクストラステージへようこそ</p> <p>ここからはほとんどの人は2時間では到達できないと思いますが、駆け足で進められた人への暇つぶしとして書いておきます😉</p></div> <p>ここまではブラウザ内で完結した処理のみを実装してきましたが、ここからはさらに実践的な例としてサーバとのやり取りを想定した実装に挑戦してみましょう。
一般的にウェブアプリといえば、ほぼこの形態です。
サーバに対してデータを保存することができれば、別のPCや他の人が同じ情報にアクセスできます。
ここまでできると、ちょっとしたSaaS(Software as a Service)ですね。</p> <p>コードの量が増えるためファイルを2つに分けます。
まず、APIクライアントの定義である、以下の内容の<code>api.tsx</code>を<code>App.tsx</code>と同じ階層(<code>src</code>の直下)に新たに作成してください。
このようなコードは実際の開発ではAPI定義より自動生成する場合もあるため、コピペで作成しても大丈夫です。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">/** 個々のToDoを表す型。*/</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">TodoItem</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">/** 全てのToDoで一意な値 */</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token comment">/** ToDoの内容 */</span>
  text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/** 完了すると`true`となる。 */</span>
  done<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * ブラウザ上で動作するAPIクライアントのモック(=それらしく動くもの)。
 * 今回はあまり内部の処理について理解する必要はなく、ToDoの配列を保持して
 * それを操作するためのメソッドを提供している、という程度の理解で十分。
 *
 * ネットワーク越しのリクエストを再現するため、各メソッドには遅延時間を設けている。
 */</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoApiMock</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> todoItems<span class="token operator">:</span> TodoItem<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">/** 条件に該当するToDoを配列で返す。 */</span>
  <span class="token keyword">async</span> <span class="token function">queryItems</span><span class="token punctuation">(</span>keyword<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> includeDone<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">simulateNetworkDelay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>todoItems<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>includeDone <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> keyword <span class="token operator">?</span> item<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 新しくToDoを作成する。 */</span>
  <span class="token keyword">async</span> <span class="token function">createItem</span><span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">simulateNetworkDelay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> newItem <span class="token operator">=</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">generateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>todoItems<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> newItem<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 既存のToDoを置き換える。 */</span>
  <span class="token keyword">async</span> <span class="token function">updateItem</span><span class="token punctuation">(</span>newItem<span class="token operator">:</span> TodoItem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">simulateNetworkDelay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>todoItems <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>todoItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      item<span class="token punctuation">.</span>id <span class="token operator">===</span> newItem<span class="token punctuation">.</span>id <span class="token operator">?</span> newItem <span class="token operator">:</span> item<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 既存のToDoを削除する。 */</span>
  <span class="token keyword">async</span> <span class="token function">deleteItem</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">simulateNetworkDelay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>todoItems <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>todoItems<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>id <span class="token operator">!==</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token function">simulateNetworkDelay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** ID用途に重複しなさそうな数値を適当に生成する。 */</span>
  <span class="token keyword">private</span> <span class="token function">generateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// モックなので適当に1970-01-01からの経過ミリ秒を利用した</span>
    <span class="token keyword">return</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * APIサーバに対してリクエストを行う実際のAPIクライアント。
 * REST風のAPIを想定している。
 *
 * ここではブラウザ標準の`fetch`を利用しているが、[Axios](https://www.npmjs.com/package/axios)
 * というライブラリを使うとこれよりも楽に書け、特にJSONの扱いが便利になる。
 */</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoApiClient</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * @example
   * new TodoApiClient('http://localhost:8080')
   */</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> baseUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">/** 条件に該当するToDoを配列で返す。 */</span>
  <span class="token keyword">async</span> <span class="token function">queryItems</span><span class="token punctuation">(</span>keyword<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> includeDone<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/todo</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>keyword <span class="token operator">!==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      url<span class="token punctuation">.</span>searchParams<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span> keyword<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>includeDone<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      url<span class="token punctuation">.</span>searchParams<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;include_done&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 新しくToDoを作成する。 */</span>
  <span class="token keyword">async</span> <span class="token function">createItem</span><span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/todo</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      method<span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
      headers<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> text <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 既存のToDoを置き換える。 */</span>
  <span class="token keyword">async</span> <span class="token function">updateItem</span><span class="token punctuation">(</span>newItem<span class="token operator">:</span> TodoItem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/todo/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>newItem<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      method<span class="token operator">:</span> <span class="token string">&quot;PUT&quot;</span><span class="token punctuation">,</span>
      headers<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>newItem<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 既存のToDoを削除する。 */</span>
  <span class="token keyword">async</span> <span class="token function">deleteItem</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/todo/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> method<span class="token operator">:</span> <span class="token string">&quot;DELETE&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br></div></div><p>このファイルは<code>TodoApiClient</code>と<code>TodoApiMock</code>を主に定義しています。</p> <p><code>TodoApiClient</code>は実際にサーバにアクセスするクライアントクラスです。
<code>TodoApiMock</code>はブラウザ上で処理が完結している「それらしく動作する」モック(=クライアントもどき)です。
実際の開発でもモックを利用しながらウェブアプリの実装を進め、ある程度形になったところで実際のサーバにアクセスし、動作を結合させたりします。</p> <p>次に<code>App.tsx</code>を以下のように<strong>丸ごと</strong>書き換えてください。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> TodoItem<span class="token punctuation">,</span> TodoApiMock<span class="token punctuation">,</span> TodoApiClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./api&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">INITIAL_TODO</span><span class="token operator">:</span> TodoItem<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&quot;todo-item-1&quot;</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&quot;todo-item-2&quot;</span><span class="token punctuation">,</span> done<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/** モックと実際のAPIクライアントを切り替えるためのコメントアウト */</span>
<span class="token keyword">const</span> todoApi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TodoApiMock</span><span class="token punctuation">(</span><span class="token constant">INITIAL_TODO</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// const todoApi = new TodoApiClient('http://localhost:8080')</span>

<span class="token keyword">type</span> <span class="token class-name">TodoListItemProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  item<span class="token operator">:</span> TodoItem<span class="token punctuation">;</span>
  <span class="token function-variable function">onCheck</span><span class="token operator">:</span> <span class="token punctuation">(</span>checked<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token function-variable function">onDelete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">TodoListItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> item<span class="token punctuation">,</span> onCheck<span class="token punctuation">,</span> onDelete <span class="token punctuation">}</span><span class="token operator">:</span> TodoListItemProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>TodoItem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">checked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>done<span class="token punctuation">}</span></span>
        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">onCheck</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>checked<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> textDecoration<span class="token operator">:</span> item<span class="token punctuation">.</span>done <span class="token operator">?</span> <span class="token string">&quot;line-through&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;none&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button-small<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">onDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        ×
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">CreateTodoFormProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">onSubmit</span><span class="token operator">:</span> <span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">CreateTodoForm</span><span class="token punctuation">(</span><span class="token punctuation">{</span> onSubmit <span class="token punctuation">}</span><span class="token operator">:</span> CreateTodoFormProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>CreateTodoForm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
        <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>新しいTodo<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">size</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">60</span><span class="token punctuation">}</span></span>
        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span>
        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setText</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">onSubmit</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">追加</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">ValueViewerProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">ValueViewer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token operator">:</span> ValueViewerProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ValueViewer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todoItems<span class="token punctuation">,</span> setTodoItems<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>TodoItem<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>keyword<span class="token punctuation">,</span> setKeyword<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>showingDone<span class="token punctuation">,</span> setShowingDone<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">reloadTodoItems</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTodoItems</span><span class="token punctuation">(</span><span class="token keyword">await</span> todoApi<span class="token punctuation">.</span><span class="token function">queryItems</span><span class="token punctuation">(</span>keyword<span class="token punctuation">,</span> showingDone<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">reloadTodoItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ToDo</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App_todo-list-control<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
          <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>キーワードフィルタ<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>keyword<span class="token punctuation">}</span></span>
          <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setKeyword</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
        <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
          <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>showing-done<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">checked</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>showingDone<span class="token punctuation">}</span></span>
          <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setShowingDone</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span>checked<span class="token punctuation">)</span><span class="token punctuation">}</span></span>
        <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">htmlFor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>showing-done<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">完了したものも表示する</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reloadTodoItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">更新</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>todoItems <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dimmed<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">データを取得中です...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span> <span class="token operator">:</span> todoItems<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dimmed<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">該当するToDoはありません</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App_todo-list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span>todoItems<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TodoListItem</span></span>
              <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>
              <span class="token attr-name">item</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span>
              <span class="token attr-name">onCheck</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">async</span> <span class="token punctuation">(</span>checked<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">await</span> todoApi<span class="token punctuation">.</span><span class="token function">updateItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>item<span class="token punctuation">,</span> done<span class="token operator">:</span> checked <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">reloadTodoItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
              <span class="token attr-name">onDelete</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">await</span> todoApi<span class="token punctuation">.</span><span class="token function">deleteItem</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">reloadTodoItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
            <span class="token punctuation">/&gt;</span></span>
          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CreateTodoForm</span></span>
        <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">async</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">await</span> todoApi<span class="token punctuation">.</span><span class="token function">createItem</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">reloadTodoItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ValueViewer</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>todoItems<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br></div></div><p>実装としてはかなり複雑になったことがわかると思います。</p> <p>主な変更点としては以下の通りです。</p> <ul><li><code>useTodoState</code>の代わりに<code>todoApi</code>のメソッドを利用している
<ul><li>つまり<code>todoItems</code>の管理の主体がコンポーネントからサーバに移動したということです
<ul><li>ただし取得したデータを保持するために<code>useState</code>を利用しています</li></ul></li> <li>ここから先は常に「マスターデータはサーバにある」という認識を持つのが良いでしょう
<ul><li>言い換えるとウェブアプリが持っているのはあくまで「ある瞬間にサーバから取得したデータのコピーである」ということです</li></ul></li></ul></li> <li><code>async/await</code>による非同期処理に対応している</li> <li><code>useEffect</code>により初回のデータ取得を自動でおこなっている</li> <li>値を追加・更新・削除した際にリストを再取得している
<ul><li>リストを取得する際に条件を与えているため、値の変更後にその条件にマッチした要素は何か、クライアント側では判断がつかないためリストを再取得する必要があります</li> <li>これも「マスターデータはサーバにある」の一種と言えます</li></ul></li></ul> <p>しかし、ここまで来れた人に多くは説明しません。
というより申し訳ないのですが、資料を用意している時間がもうないためここから先は好きなように進めてください。
あとついでにですが、もとのToDoアプリのコードとのつながりを優先したせいで、コンポーネントが妥当な機能の切り分けになっていないと思います。</p> <p>「こうしたらいいんじゃないかな」という点は次の発展課題に上げておいたので、どうかいい感じにしてやってください…🥺すみません…</p> <h3 id="サーバを立ててアクセスしてみる-vite環境のみ"><a href="#サーバを立ててアクセスしてみる-vite環境のみ" class="header-anchor">#</a> サーバを立ててアクセスしてみる(Vite環境のみ)</h3> <p>残念ながらCodeSandboxでは実行できないためモックで我慢してください🥺</p> <p>APIサーバのコンテナイメージを用意してありますので、以下のようにローカルでサーバを立ててサーバへのアクセスを実際に試してみてください。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> run --rm -p <span class="token number">8080</span>:8080 ghcr.io/asa-taka/bootcamp-todo-api --port<span class="token operator">=</span><span class="token number">8080</span> --host<span class="token operator">=</span><span class="token number">0.0</span>.0.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>これを実行すると<a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">http://localhost:8080<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>でAPIサーバが動作します。
試しにブラウザで<a href="http://localhost:8080/todo" target="_blank" rel="noopener noreferrer">http://localhost:8080/todo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を表示するとToDoのデータのJSONが表示されれば成功です😉</p> <p>この状態でコード中の、モックと切り替えるためのコメントアウトを入れ替えると、ウェブアプリからもアクセスされるようになるはずです。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// const todoApi = new TodoApiMock(INITIAL_TODO);</span>
<span class="token keyword">const</span> todoApi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TodoApiClient</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="発展課題-2"><a href="#発展課題-2" class="header-anchor">#</a> 発展課題</h3> <p>時間に余裕があれば挑戦してみてください。</p> <ul><li>更新中の状態をユーザに伝えたい</li> <li>条件を変更した時に自動でリストを更新したい</li> <li>apiを呼ぶ処理はTodoItemの方に寄せてもいい
<ul><li>reloadする処理をどうするか</li></ul></li> <li>エラーレスポンスに対してはどうするか</li></ul> <p>ただし、実際にはこのあたりの実装は<a href="https://tanstack.com/query/v3/" target="_blank" rel="noopener noreferrer">react-query<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>などのパッケージを利用することが多いです。</p> <h3 id="アプリをビルドしてコンテナ化する-vite環境のみ"><a href="#アプリをビルドしてコンテナ化する-vite環境のみ" class="header-anchor">#</a> アプリをビルドしてコンテナ化する(Vite環境のみ)</h3> <p>発展課題のついでのおまけのおまけです。アプリをビルドしてついでにコンテナ化しましょう😉</p> <p>ウェブアプリケーションの「ビルド」とは <strong>ブラウザが解釈できる純粋なHTMLとCSSとJavaScript</strong> をソースコードから生成することを指します。</p> <p>プロジェクトのルートディクトリ(フォルダの一番上の階層)に移動して、以下の内容で<code>Dockerfile</code> という名前のファイルを作ってください。</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> nginx:1.25.2</span>
<span class="token instruction"><span class="token keyword">COPY</span> ./dist /usr/share/nginx/html</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>フォルダ内の構成はこのようになります。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(ルートディレクトリ)
├── Dockerfile
├── src
└── (その他のファイル)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>この状態で、同じくルートディレクトリで以下のコマンドを実行することで、コンテナイメージを作成することができます(ちょっと雑な作り方です)。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># distフォルダにビルドされたウェブアプリが生成される。</span>
<span class="token function">npm</span> run build

<span class="token comment"># distフォルダを取り込んだnginx(ウェブサーバ)のコンテナイメージを作成する。</span>
<span class="token function">docker</span> build <span class="token builtin class-name">.</span> -t todo-web

<span class="token comment"># コンテナを動かし9000番ポートでウェブアプリを公開する。</span>
<span class="token function">docker</span> run --rm -p <span class="token number">9000</span>:80 todo-web
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>この状態で<a href="http://localhost:9000" target="_blank" rel="noopener noreferrer">http://localhost:9000<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>にアクセスして、今までと同様のウェブアプリが表示されれば成功です😉</p> <p>アプリをコンテナイメージとしてまとめることで、利用者がアプリを動かすためのセットアップが簡単にできたり、Kubernetes環境でアプリを動作させることができます。</p> <div class="custom-block tip"><p class="custom-block-title">えっ、ここまでできたんですか？</p> <p>ちょっと、できる人すぎですよ😉</p></div> <h2 id="参考になるサイト"><a href="#参考になるサイト" class="header-anchor">#</a> 参考になるサイト</h2> <h3 id="react-2"><a href="#react-2" class="header-anchor">#</a> React</h3> <ul><li>React公式: <a href="https://react.dev" target="_blank" rel="noopener noreferrer">https://react.dev<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>とても親切にまとめられていますし<a href="https://ja.react.dev" target="_blank" rel="noopener noreferrer">日本語訳<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>もあります</li> <li>Stateやプロパティ、Hookについて理解を深めるのにとても役にたちます</li></ul></li></ul> <h3 id="javascript"><a href="#javascript" class="header-anchor">#</a> JavaScript</h3> <ul><li>MDN: <a href="https://developer.mozilla.org/ja/docs/Web" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/ja/docs/Web<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>Mozilla(Firefoxを開発しているところ)によるJavaScriptリファレンスです</li> <li>日本語訳も充実しており、JavaScriptの個々のAPIについて調べる場合は一番わかりやすいと思います</li></ul></li></ul> <h3 id="typescript-2"><a href="#typescript-2" class="header-anchor">#</a> TypeScript</h3> <ul><li>TypeScript公式: <a href="https://www.typescriptlang.org" target="_blank" rel="noopener noreferrer">https://www.typescriptlang.org<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>英語しかないので難しいかもしれません</li></ul></li> <li><a href="https://typescript-jp.gitbook.io/deep-dive/type-system" target="_blank" rel="noopener noreferrer">TypeScript Deep Dive 日本語版<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>以上で講義は終わりです。よいReactライフを😉</p> <div><hr> <span>CC BY-SA Licensed | Copyright (c) 2020, Internet Initiative Japan Inc.</span></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/iij/bootcamp/edit/master/src/frontend/react/README.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/22/2024, 12:25:30 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/bootcamp/assets/js/app.cf20b39e.js" defer></script><script src="/bootcamp/assets/js/2.09c5bc7f.js" defer></script><script src="/bootcamp/assets/js/9.9b3be782.js" defer></script><script src="/bootcamp/assets/js/17.98516af4.js" defer></script><script src="/bootcamp/assets/js/16.fd8c1616.js" defer></script>
  </body>
</html>
